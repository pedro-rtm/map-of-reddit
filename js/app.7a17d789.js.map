{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/SmallPreview.vue?58ab","webpack:///./src/components/Typeahead.vue?719e","webpack:///./src/App.vue?62a1","webpack:///./src/lib/bus.js","webpack:///./src/lib/utils.js","webpack:///./src/lib/createSVGLoader.js","webpack:///./src/lib/PointCollection.js","webpack:///./src/lib/PolyLineCollection.js","webpack:///./src/lib/MSDFTextCollection.js","webpack:///./src/lib/ColoredTextCollection.js","webpack:///./src/lib/createFuzzySearcher.js","webpack:///./src/appState.js","webpack:///./src/lib/constants.js","webpack:///./src/lib/LineCollection.js","webpack:///./src/lib/createPointerEventsHandler.js","webpack:///./src/lib/getComplimentaryColor.js","webpack:///./src/lib/createSubgraphVisualizer.js","webpack:///./src/lib/createSceneLayerManager.js","webpack:///./src/lib/BoxCollection.js","webpack:///./src/lib/createStreetView.js","webpack:///./src/lib/createStreamingSVGRenderer.js","webpack:///./src/Tooltip.vue?8539","webpack:///./src/lib/clickOutside.js","webpack:///src/Tooltip.vue","webpack:///./src/Tooltip.vue?9cdf","webpack:///./src/Tooltip.vue","webpack:///./src/components/Typeahead.vue?56ea","webpack:///src/components/Typeahead.vue","webpack:///./src/components/Typeahead.vue?cdb2","webpack:///./src/components/Typeahead.vue","webpack:///./src/components/Sidebar.vue?f4ca","webpack:///src/components/Sidebar.vue","webpack:///./src/components/Sidebar.vue?350d","webpack:///./src/components/Sidebar.vue","webpack:///./src/components/ImproveWindow.vue?f28e","webpack:///src/components/ImproveWindow.vue","webpack:///./src/components/ImproveWindow.vue?ce01","webpack:///./src/components/ImproveWindow.vue","webpack:///./src/SmallPreview.vue?385b","webpack:///./src/LoadingIcon.vue?34ff","webpack:///./src/LoadingIcon.vue","webpack:///src/SmallPreview.vue","webpack:///./src/SmallPreview.vue?0cb4","webpack:///./src/SmallPreview.vue","webpack:///./src/lib/createFirstInteractionListener.js","webpack:///src/App.vue","webpack:///./src/App.vue?6796","webpack:///./src/App.vue","webpack:///./src/main.js","webpack:///./src/App.vue?b219"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","jsonpScriptSrc","p","exports","module","l","e","promises","installedChunkData","promise","Promise","resolve","reject","onScriptComplete","script","document","createElement","charset","timeout","nc","setAttribute","src","error","Error","event","onerror","onload","clearTimeout","chunk","errorType","type","realSrc","target","message","name","request","undefined","setTimeout","head","appendChild","all","m","c","d","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","oe","err","console","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","isWebGLEnabled","_e","_m","staticClass","_v","_s","progressMessage","subgraphName","isStreetViewMode","on","$event","preventDefault","onSubgraphRootClick","onExitSubgraph","isStreetViewInProgress","onExitStreetView","subreddit","defaultSort","defaultTime","onDeclineAge","slot","showRelated","streetViewEnabled","graphLoaded","isSubgraphLayoutInProgress","showStreetView","directives","rawName","expression","domProps","Array","isArray","multiView","_i","$$a","$$el","$$c","checked","$$v","$$i","concat","onSubmit","appState","query","sidebarVisible","findSubreddit","closeSubredditOnSmallScreen","closeSubredditViewer","onTypeAheadInput","class","subgraph","street","onImproveClick","smallPreview","improveVisible","style","left","tooltip","x","top","y","onBackdropClick","staticRenderFns","bus","eventify","setProgress","msg","fire","debounce","cb","ms","self","handle","lastCall","Date","time","elapsed","arguments","formatNumber","toString","replace","createSVGLoader","url","disposed","graph","createGraph","parseSVGAsync","createStreamingSVGParser","notifyTagOpen","notifyTagClose","api","load","dispose","getGraph","start","performance","now","getLinksCount","getLinkCount","getPathTo","indexOf","baseUrl","URL","pathname","substr","lastIndexOf","fetch","then","response","fetchReader","body","getReader","decoder","TextDecoder","read","processData","progress","decode","stream","done","log","text","txt","labels","split","forEach","label","addNode","fromId","prevBuffer","weight","mapLoaded","tmp","Uint8Array","byteLength","set","lastAvailableByte","Math","floor","view","DataView","buffer","linkId","getInt32","toId","addLink","element","PointCollection","gl","program","defineProgram","vertex","fragment","attributes","color","ColorAttribute","instanced","point","InstancedAttribute","preDrawHook","postDrawHook","opacity","hidden","drawContext","uniforms","modelViewProjection","cameraDistance","position","draw","setCount","GLCollection","PolyLineCollection","options","debug","polygon","flat","triangles","earcut","index","add","MSDFTextCollection","getExtension","getTextProgram","img","msdfImage","Image","crossOrigin","isReady","queue","fontSize","fontInfo","fontPath","json","alphabet","Map","chars","char","charValue","String","fromCharCode","id","_sdfTextureChanged","setTextureCanvas","sdfTextureWidth","width","sdfTextureHeight","height","q","addText","bias","textInfo","z","dx","limit","w","sdfPos","xadvance","info","size","scale","cx","cy","yoffset","charSize","texturePosition","scene","renderFrame","capacity","ColoredTextCollection","fuzzysort","require","createFuzzySearcher","lastPromise","words","addWord","find","word","cancel","goAsync","results","map","html","highlight","pendingSave","qs","state","instance","useSearch","versionToLink","1","2","lastVersion","latestGraphLink","versionMissing","graphDefined","userTypedSomething","getFilePath","version","saveQuery","newQuery","newState","unset","getQueryState","getCameraPosition","coordinates","v","Number","parseFloat","isFinite","filter","saveScenePosition","dc","getDrawContext","Colors","PRIMARY_HIGHLIGHT_COLOR","SECONDARY_HIGHLIGHT_COLOR","TERNARY_COLOR","TERNARY_LINK","LayerLevels","Polygons","Edges","HighlightedEdges","Nodes","Labels","Text","NamedGroups","MainGraph","LineCollection","createPointerEventsHandler","sceneLayerManager","spatialIndex","RBush","moved","isPaused","maxCameraDistance","getScene","handleClick","handleMove","handleTransform","highlightedNodes","getGL","primaryWidth","getPrimaryLineWidth","firstLevelArrows","secondLevelArrows","addToLayer","elementsGroupName","addToNamedGroup","clearHighlights","focusUI","setPaused","getIndex","setViewBox","newBox","max","cameraZPosition","onTransform","k","pixelWidth","getSceneWidthForPixelWidth","getSceneCoordinate","bottom","abs","clear","ui","getHighlightedLinks","linkUI","links","isFirstLevel","getHighlightedNodes","nodeUI","insert","minX","minY","maxX","maxY","removeChild","off","findNearest","newIsPaused","originalEvent","clientX","clientY","neighborIds","knn","neighbor","uiX","uiY","dist","hypot","getComplimentaryColor","lightningFactor","alpha","g","b","rgbToHsl","h","hslToRgb","min","r0","g0","b0","hue2rgb","round","createLayout","FLOOR_COLOR","EDGE_COLOR","Easing","easeInQuart","createSubgraphVisualizer","viewBox","nodeNameToUI","layout","raf","MAX_FRAMES","renderCount","moveThreshold","prevSize","ourNodeNameToUI","points","TextCollection","boundariesFill","transitionAnimator","createTransitionAnimator","pointerEvents","focusSubgraphNode","getPointerEvents","getNameToUI","run","hlNode","nodeUIs","forEachLinkedNode","other","linkUIs","forEachLink","link","from","to","onSceneIsBack","cancelAnimationFrame","parent","startSceneRestoration","startFadeOut","beginLayout","minSize","Infinity","maxSize","forEachNode","node","timeStep","springLength","springCoefficient","gravity","nodeMass","nodeId","rememberAndSetOriginalPositions","requestAnimationFrame","frame","step","bboxSize","updateNodePositions","movedLength","finishRendering","getBoundingRect","getRootNodeId","root","isRoot","getNodePosition","rootNode","subgraphDone","concaveman","default","addPolygon","boundingRect","right","pos","update","copyPosition","ourUI","setNodePosition","durationInFrames","zoomOutViewBox","currentStep","zoomStart","zoomEnd","changeRectangleFinishedCallback","doneCallback","positions","startZoomOut","startZoomIn","getCurrentBoundingRectangle","changeRectangle","side","tan","fov","pixelRatio","getNamedGroup","elements","el","hideNamedGroup","current","nodeCollections","immediate","restoreNamedGroup","fadeIn","lerp","createSceneLayerManager","namedGroups","groupName","group","isHidden","layer","layerIndex","rootElement","getRoot","lastElementWithLowerLayerIndex","children","warn","insertChildAfter","tex","BoxCollection","uiIDToUI","camera","box","setFaceColor","front","back","face","uiId","frontUI","leftUI","rightUI","backUI","topUI","getFace","rotateFace","PI","translateFace","addFace","removeFace","angle","axis","cos","sin","x0","y0","z0","quadPoints","texCoordinate","quadUI","oldId","newId","remove","movedUI","delete","createStreetView","nameToUI","fpsUI","boxes","items","asyncRender","enter","exit","lookAt","visibleBoxes","Set","visibilityUpdate","uiToBox","visibleElements","lastVisibilityUpdate","domContainer","DomContainer","seeThrough","a","cameraController","getCameraController","setCameraController","fpsControls","minDimension","moveSpeed","setMoveSpeed","setScrollSpeed","setFlySpeed","enableMouseCapture","createFPSControlsUI","renderFirstBatch","scheduleVisibilityUpdate","neighbors","item","addBox","renderTheRest","processNext","localCount","has","streetViewDone","hideElement","mapControls","showElement","dom","dy","sqrt","DomElement","ox","oy","oz","vec3","cross","normalize","quat","rotationTo","rotateZ","mat4","fromRotationTranslationScale","model","worldTransformNeedsUpdate","updated","updateVisibility","eye","center","lookDirection","getDirection","getMostVisibleNeighbors","sort","nowVisible","intersections","minT","minFace","checkFaceIntersection","count","castRay","r_px","r_py","s_px","s_py","s_dx","s_dy","r_dx","r_dy","t2","ta","isNaN","dir","maxCount","maxAngle","checkAngle","candidate","candidateDirection","dot","acos","out","len","createStreamingSVGRenderer","canvas","preStreetViewCameraPosition","inputTarget","streetView","ignoreSVGViewBox","isStreetView","initScene","fuzzySearcher","loader","subgraphVisualizer","persistedName","nodes","labelsText","currentTransform","createTransformParser","nodesByComponent","complimentaryColor","clusterColors","setProgressDebounced","focusNode","unfocus","exitSubgraphMode","loadSVG","focus","exitStreetView","getNeighbors","componentId","idx","maxLinks","secondaryLinkColor","neighborId","trim","currentPointerEvents","hide","show","lookAtNode","otherNode","subgraphNodes","addNeighbors","neighborsSet","runSubGraphVisualizer","addedNode","getNode","isFirstChild","hasLink","isRootLevel","nodeName","path","handleElementStart","handleElementEnd","tagName","viewBoxArr","finiteNumber","addBorder","transform","pushTransform","popTransform","innerText","appendTextLabel","getNumericAttribute","hexColor","getElementFillColor","transformY","getTextAttribute","getLoadedSubreddits","parseBorder","clusterId","querySelector","createScene","allowPinchRotation","near","minZoom","useDeviceOrientation","setClearColor","cameraPosition","initialSceneSize","getPointsFromPathData","isDirty","tx","ty","transformStack","transformStr","parseTransform","pop","str","transformNumbers","match","coefficients","updateTransform","record","defaultValue","rgbArray","startClick","component","menuClicked","ref","placeholder","currentQuery","handleInput","cycleTheList","showClearButton","clearSearch","_l","suggestion","selected","pickSuggestion","loadingError","nodeList","ctx","seed","createDocumentHandler","binding","vnode","mouseup","mousedown","context","contains","popperElm","methodName","bindingFn","addEventListener","documentHandler","unbind","onClose","showFullPreview","details","subscribers","active","image","icon","description","createFirstInteractionListener","callback","handleFirstEvent","called","removeEventListener","isSmallScreen","getFirstSubreddit","potentiallyMultiViewName","Vue","config","productionTip","render","App","$mount"],"mappings":"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","file":"js/app.7a17d789.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"js/\" + ({}[chunkId]||chunkId) + \".\" + {\"chunk-9475eac2\":\"1e9ebc1b\"}[chunkId] + \".js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\t// create error before stack unwound to get useful stacktrace later\n \t\t\t\tvar error = new Error();\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n \t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--12-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--12-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--12-oneOf-1-2!../node_modules/stylus-loader/index.js??ref--12-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./SmallPreview.vue?vue&type=style&index=0&lang=stylus&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--12-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--12-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--12-oneOf-1-2!../../node_modules/stylus-loader/index.js??ref--12-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Typeahead.vue?vue&type=style&index=0&lang=stylus&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[(!_vm.isWebGLEnabled)?_c('div',[_vm._m(0)]):_vm._e(),(_vm.isWebGLEnabled)?_c('div',[_c('transition',{attrs:{\"name\":\"fade\"}},[(_vm.progressMessage)?_c('div',{staticClass:\"progress\"},[_vm._v(_vm._s(_vm.progressMessage))]):_vm._e()]),_c('transition',{attrs:{\"name\":\"fade\"}},[(_vm.subgraphName && !_vm.isStreetViewMode)?_c('div',{staticClass:\"progress subgraph\"},[_vm._v(\" Only \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.onSubgraphRootClick($event)}}},[_vm._v(\"/r/\"+_vm._s(_vm.subgraphName))]),_vm._v(\" related subreddits are shown. \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.onExitSubgraph($event)}}},[_vm._v(\"view all\")])]):_vm._e()]),_c('transition',{attrs:{\"name\":\"fade\"}},[(_vm.isStreetViewMode && !_vm.isStreetViewInProgress)?_c('div',{staticClass:\"progress subgraph\"},[_c('a',{staticClass:\"accent\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.onExitStreetView($event)}}},[_vm._v(\"exit street view\")])]):_vm._e()]),(_vm.subreddit)?_c('subreddit',{staticClass:\"preview\",attrs:{\"name\":_vm.subreddit,\"sort\":_vm.defaultSort,\"time\":_vm.defaultTime},on:{\"declineAge\":_vm.onDeclineAge}},[_c('template',{slot:\"after-title\"},[_c('div',[(_vm.graphLoaded)?_c('a',{staticClass:\"subreddit-action\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.showRelated($event)}}},[_vm._v(\"Show related\")]):_vm._e(),(_vm.streetViewEnabled && _vm.graphLoaded && !_vm.isSubgraphLayoutInProgress)?_c('a',{staticClass:\"subreddit-action\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.showStreetView($event)}}},[_vm._v(\"Street view\")]):_vm._e(),(_vm.graphLoaded)?_c('div',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.multiView),expression:\"multiView\"}],attrs:{\"type\":\"checkbox\",\"id\":\"checkbox\"},domProps:{\"checked\":Array.isArray(_vm.multiView)?_vm._i(_vm.multiView,null)>-1:(_vm.multiView)},on:{\"change\":function($event){var $$a=_vm.multiView,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.multiView=$$a.concat([$$v]))}else{$$i>-1&&(_vm.multiView=$$a.slice(0,$$i).concat($$a.slice($$i+1)))}}else{_vm.multiView=$$c}}}}),_c('label',{attrs:{\"for\":\"checkbox\"}},[_vm._v(\"Multireddit view from neighbors\")])]):_vm._e(),(!_vm.graphLoaded)?_c('span',{staticClass:\"subreddit-action\"},[_vm._v(\"the map is still loading...\")]):_vm._e()])])],2):_vm._e(),_c('form',{staticClass:\"search-box\",on:{\"submit\":function($event){$event.preventDefault();return _vm.onSubmit($event)}}},[_c('typeahead',{attrs:{\"placeholder\":\"Find subreddit\",\"showClearButton\":_vm.subreddit,\"query\":_vm.appState.query},on:{\"menuClicked\":function($event){_vm.sidebarVisible = true},\"selected\":_vm.findSubreddit,\"beforeClear\":_vm.closeSubredditOnSmallScreen,\"cleared\":_vm.closeSubredditViewer,\"inputChanged\":_vm.onTypeAheadInput}})],1),(_vm.graphLoaded && _vm.progressMessage === null)?_c('div',{staticClass:\"support\",class:{subgraph: _vm.subgraphName && !_vm.isStreetViewMode, street: _vm.isStreetViewMode}},[_vm._v(\" Enjoying this map? \"),_c('br'),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://patreon.com/anvaka\",\"target\":\"_blank\"}},[_vm._v(\"Support the author\")])]):_vm._e(),_c('a',{staticClass:\"accent improve\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.onImproveClick($event)}}},[_vm._v(\"Improve this map\")]),_c('transition',{attrs:{\"name\":\"slide-bottom\"}},[(_vm.smallPreview)?_c('small-preview',{staticClass:\"small-preview\",attrs:{\"name\":_vm.smallPreview}}):_vm._e()],1),_c('transition',{attrs:{\"name\":\"slide-top\"}},[(_vm.improveVisible)?_c('improve-window',{staticClass:\"improve-window\",on:{\"close\":function($event){_vm.improveVisible = false}}}):_vm._e()],1),(_vm.tooltip)?_c('tooltip',{staticClass:\"tooltip\",style:({\n    left: _vm.tooltip.x + 'px',\n    top: _vm.tooltip.y + 'px'\n  }),attrs:{\"data\":_vm.tooltip}}):_vm._e(),_c('transition',{attrs:{\"name\":\"fade\"}},[(_vm.sidebarVisible || _vm.improveVisible)?_c('div',{staticClass:\"backdrop\",on:{\"click\":_vm.onBackdropClick}}):_vm._e()]),_c('transition',{attrs:{\"name\":\"slide-left\"}},[(_vm.sidebarVisible)?_c('sidebar',{on:{\"close\":function($event){_vm.sidebarVisible = false}}}):_vm._e()],1)],1):_vm._e()])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"absolute no-webgl\"},[_c('h4',[_vm._v(\"WebGL is not enabled :(\")]),_c('p',[_vm._v(\"This website needs \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://en.wikipedia.org/wiki/WebGL\"}},[_vm._v(\"WebGL\")]),_vm._v(\" to render a map of reddit. \")]),_vm._v(\" \"),_c('p',[_vm._v(\" You can try another browser. If the problem persists - very likely your video card isn't supported. \")])])}]\n\nexport { render, staticRenderFns }","import eventify from 'ngraph.events';\n\nconst bus = eventify({});\n\nexport default bus;\n\nexport function setProgress(msg) {\n    bus.fire('progress', msg());\n}","\nexport function debounce(cb, ms, self) {\n  let lastCall = new Date();\n  let handle;\n\n  return function() {\n    let time = new Date();\n    let elapsed = time - lastCall;\n    clearTimeout(handle);\n    if (elapsed > ms) {\n      cb.apply(self, arguments)\n    } else {\n      lastCall = time;\n      handle = setTimeout(cb, ms, arguments)\n    }\n  }\n}\n\nexport function formatNumber(x) {\n  return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}","import eventify from 'ngraph.events';\nimport createGraph from 'ngraph.graph';\nimport {createStreamingSVGParser} from 'streaming-svg-parser';\nimport {setProgress} from './bus';\nimport {formatNumber} from './utils';\n\nexport default function createSVGLoader(url) {\n  let disposed = false;\n  let graph = createGraph();\n  let parseSVGAsync = createStreamingSVGParser(notifyTagOpen, notifyTagClose, true)\n\n  let api = eventify({load, dispose, getGraph() { return graph; }});\n  return api;\n\n  function dispose() {\n    disposed = true;\n  }\n\n  function load() {\n    let start = window.performance.now();\n    fetch(url, {mode: 'cors'}).then(response => {\n      let fetchReader = response.body.getReader();\n      let decoder = new TextDecoder();\n\n      return fetchReader.read().then(processData);\n\n      function processData(progress) {\n        if (disposed) return;\n\n        let chunk = (progress.value !== undefined && decoder.decode(progress.value, {stream: !progress.done})) || '';\n        return parseSVGAsync(chunk).then(() => {\n          if(progress.done) {\n            return;\n          }\n          return fetchReader.read().then(processData);\n        });\n      }\n    }).then(() => {\n      console.log('Elapsed: ', window.performance.now() - start);\n      setProgress(() => ({\n        message: 'Loading links...'\n      }));\n      // now the svg file is loaded. Let's load secondary information\n      return fetch(getPathTo('node-ids.txt'), {mode: 'cors'}).then(response => response.text()).then(txt => {\n        let labels = txt.split('\\n');\n        labels.forEach(label => graph.addNode(label));\n        return labels;\n      });\n    }).then((labels) => {\n      // now load the edges:\n      let fromId, fetchReader, prevBuffer, weight;\n      return fetch(getPathTo('links.bin'), {mode: 'cors'})\n      .then(response => {\n        fetchReader = response.body.getReader();\n        return fetchReader.read().then(processData);\n      });\n\n      function processData(progress) {\n        if (disposed) return;\n\n        let chunk = progress.value;\n        if (!chunk && prevBuffer) {\n          throw new Error('Incomplete response');\n        }\n        if (!chunk) {\n          setProgress(() => ({\n            mapLoaded: true,\n          }));\n          return graph;\n        }\n\n        if (prevBuffer) {\n          let tmp = new Uint8Array(prevBuffer.byteLength + chunk.byteLength);\n          tmp.set(new Uint8Array(prevBuffer), 0);\n          tmp.set(new Uint8Array(chunk), prevBuffer.byteLength);\n          chunk = tmp;\n          prevBuffer = null;\n        }\n        let lastAvailableByte = Math.floor(chunk.byteLength / 4) * 4;\n        if (chunk.byteLength % 4 !== 0) {\n          prevBuffer = chunk.slice(lastAvailableByte);\n        }\n        const view = new DataView(chunk.buffer);\n        for (let i = 0; i < lastAvailableByte; i += 4) {\n          let linkId = view.getInt32(i, /* little endian = */ true);\n          if (linkId < 0) {\n            fromId = -linkId - 1;\n            weight = 1;\n            graph.addNode(labels[fromId]);\n          } else {\n            let toId = linkId - 1;\n            graph.addLink(labels[fromId], labels[toId], weight)\n            weight += 1;\n          }\n        }\n\n        if (progress.done) {\n          setProgress(() => ({\n            mapLoaded: true\n          }));\n          return graph;\n        }\n        setProgress(getLinksCount);\n        return fetchReader.read().then(processData);\n      }\n    });\n\n    function getLinksCount() {\n      return {\n        message: 'Loaded ' + formatNumber(graph.getLinkCount()) + ' relationship records'\n      }\n    }\n\n    function getPathTo(name) {\n      if (url.indexOf('http') < 0) return name;\n      let baseUrl = new URL(url);\n      baseUrl.pathname = baseUrl.pathname.substr(0, baseUrl.pathname.lastIndexOf('/') + 1) + name;\n      return baseUrl.toString();\n    }\n\n    return api;\n  }\n\n  function notifyTagOpen(element) {\n    api.fire('element-start', element);\n  }\n\n  function notifyTagClose(element) {\n    api.fire('element-end', element)\n  }\n\n}","\nimport {GLCollection, defineProgram, ColorAttribute, InstancedAttribute} from 'w-gl';\n\nexport default class PointCollection extends GLCollection {\n  constructor(gl) {\n    let program = defineProgram({\n      gl,\n      vertex: `\n  uniform mat4 modelViewProjection;\n  uniform float opacity;\n  uniform float cameraDistance;\n\n  attribute float size;\n  attribute vec3 position;\n  attribute vec4 color;\n\n  attribute vec2 point; // instanced\n\n  varying vec4 vColor;\n  varying vec2 vPoint;\n  void main() {\n    gl_Position = modelViewProjection * vec4(position + vec3(point * size, 0.), 1.0);\n    vColor = color.abgr;\n    vColor[3] *= opacity *  (1. - smoothstep(0.0, 1., cameraDistance / (3000. * size)));\n    vPoint = point;\n  }`,\n\n      fragment: `\n  precision highp float;\n  varying vec4 vColor;\n  varying vec2 vPoint;\n  void main() {\n    float dist = length(vPoint);\n    if (dist >= 0.5) {discard;}\n    gl_FragColor = vColor;\n  }`,\n      // These are just overrides:\n      attributes: {\n        color: new ColorAttribute(),\n      },\n      instanced: {\n        point: new InstancedAttribute([\n          -0.5, -0.5, -0.5,  0.5, 0.5,  0.5,\n          0.5,  0.5, 0.5, -0.5, -0.5, -0.5,\n        ])\n      },\n\n      preDrawHook(/* programInfo */) {\n        return `gl.enable(gl.DEPTH_TEST);\n        gl.depthFunc(gl.LEQUAL);`;\n      },\n      postDrawHook() {\n        return 'gl.disable(gl.DEPTH_TEST);';\n      },\n    });\n\n    super(program);\n    this.opacity = 1;\n    this.hidden = false;\n  }\n  hide() {\n    this.hidden = true;\n  }\n  show() {\n    this.hidden = false;\n  }\n  draw(gl, drawContext) {\n    if (this.hidden) return;\n    if (!this.uniforms) {\n      this.uniforms = {\n        modelViewProjection: this.modelViewProjection,\n        opacity: this.opacity\n      };\n    }\n    this.uniforms.opacity = this.opacity;\n    this.uniforms.cameraDistance = drawContext.view.position[2];\n    this.program.draw(this.uniforms);\n  }\n\n  clear() {\n    this.program.setCount(0);\n  }\n}","import earcut from 'earcut';\nimport {defineProgram, ColorAttribute, GLCollection} from 'w-gl';\n\nexport default class PolyLineCollection extends GLCollection {\n  constructor(gl, options = {}) {\n    let program = defineProgram({\n      gl,\n      debug: options.debug,\n      vertex: `\n  uniform mat4 modelViewProjection;\n  uniform float opacity;\n\n  attribute vec2 point;\n  attribute vec4 color;\n  varying vec4 vColor;\n\n  void main() {\n    gl_Position = modelViewProjection * vec4(point, -1.0, 1.0);\n    vColor = color.abgr;\n    vColor[3] *= opacity;\n  }`,\n\n      fragment: `\n  precision highp float;\n\n  varying vec4 vColor;\n\n  void main() {\n    gl_FragColor = vColor;\n  }`,\n      attributes: {\n        color: new ColorAttribute(),\n      },\n    });\n    super(program);\n    this.opacity = options.opacity === undefined ? 1 : options.opacity;\n    this.color = options.color || 0x000000ff;\n  }\n\n  draw() {\n    if (!this.uniforms) {\n      this.uniforms = {\n        modelViewProjection: this.modelViewProjection,\n        opacity: this.opacity\n      };\n    }\n    this.uniforms.opacity = this.opacity;\n    this.program.draw(this.uniforms);\n  }\n\n  clear() {\n    this.program.setCount(0);\n  }\n\n  addPolygon({ polygon, color }) {\n    polygon = polygon.flat();\n    let triangles = earcut(polygon);\n    for (let i = 0; i < triangles.length; i++) {\n      let index = triangles[i] * 2;\n      this.add({\n        point: [polygon[index], polygon[index + 1]],\n        color: color || this.color,\n      });\n    }\n\n    for (let i = 0; i < 3; ++i) {\n      this.add({\n        point: [0, 0],\n        color: 0x0,\n      });\n    }\n  }\n}\n","import { defineProgram, InstancedAttribute, GLCollection } from 'w-gl';\n\nexport default class MSDFTextCollection extends GLCollection {\n  constructor(gl, options = {}) {\n    gl.getExtension('OES_standard_derivatives');\n\n    super(getTextProgram(gl, options));\n\n    let img = (this.msdfImage = new Image());\n    img.crossOrigin = 'Anonymous';\n    this.isReady = false;\n    this.queue = [];\n    this.fontSize = options.fontSize || 2;\n    this.opacity = options.opacity !== undefined ? options.opacity : 1;\n    this.fontInfo = null;\n\n    let fontPath = 'fonts';\n    fetch(`${fontPath}/Roboto.json`, { mode: 'cors' })\n      .then((x) => x.json())\n      .then((fontInfo) => {\n        this.fontInfo = fontInfo;\n        this.alphabet = new Map();\n        fontInfo.chars.forEach((char) => {\n          let charValue = String.fromCharCode(char.id);\n          this.alphabet.set(charValue, char);\n        });\n\n        this.msdfImage.onload = () => {\n          this._sdfTextureChanged = true;\n          this.program.setTextureCanvas('msdf', this.msdfImage);\n          this.isReady = true;\n          this.sdfTextureWidth = img.width;\n          this.sdfTextureHeight = img.height;\n\n          this.queue.forEach((q) => this.addText(q));\n          this.queue = [];\n        };\n        this.msdfImage.src = `${fontPath}/Roboto0.png`;\n      });\n  }\n\n  clear() {\n    this.program.setCount(0);\n  }\n\n  draw(gl, drawContext) {\n    if (!this.uniforms) {\n      this.uniforms = {\n        modelViewProjection: this.modelViewProjection,\n        color: [0.9, 0.9, 0.9, 1.0],\n        bias: 0.5,\n        opacity: this.opacity\n      };\n    }\n\n    this.uniforms.cameraDistance = drawContext.view.position[2];\n    this.uniforms.opacity = this.opacity;\n\n    // This draws text outline. TODO: Can I get rid of this call?\n    this.uniforms.color[0] = 0.2;\n    this.uniforms.color[1] = 0.4;\n    this.uniforms.color[2] = 0.8;\n    this.uniforms.color[3] = 0.8;\n    this.uniforms.bias = 0.35;\n    this.program.draw(this.uniforms);\n\n    // This draws text itself\n    this.uniforms.color[0] = 0.9;\n    this.uniforms.color[1] = 0.9;\n    this.uniforms.color[2] = 0.9;\n    this.uniforms.color[3] = 1;\n    this.uniforms.bias = 0.5;\n    this.program.draw(this.uniforms);\n  }\n\n  addText(textInfo) {\n    if (!this.isReady) {\n      this.queue.push(textInfo);\n      return;\n    }\n    let { text, x = 0, y = 0, z = 0 } = textInfo;\n    if (text === undefined) {\n      throw new Error('Text is not defined in ' + textInfo);\n    }\n    let dx = 0;\n    let fontSize = textInfo.fontSize || this.fontSize;\n    if (textInfo.limit !== undefined) {\n      let w = 0;\n      for (let char of text) {\n        let sdfPos = this.alphabet.get(char);\n        if (!sdfPos) continue;\n        w += sdfPos.xadvance;\n      }\n      fontSize = (textInfo.limit * this.fontInfo.info.size) / w;\n    }\n\n    let scale = fontSize / this.fontInfo.info.size;\n    if (textInfo.cx !== undefined) {\n      let w = 0;\n      for (let char of text) {\n        let sdfPos = this.alphabet.get(char);\n        if (!sdfPos) continue;\n\n        w += sdfPos.xadvance;\n      }\n      dx -= w * textInfo.cx * scale;\n    }\n    if (textInfo.cy !== undefined) {\n      y += fontSize * textInfo.cy;\n    }\n\n    for (let char of text) {\n      let sdfPos = this.alphabet.get(char);\n      if (!sdfPos) {\n        console.error(char + ' is missing in the font');\n        continue;\n      }\n\n      this.add({\n        position: [x + dx, y - sdfPos.yoffset * scale, z],\n        charSize: [\n          (fontSize * sdfPos.width) / 42,\n          (-fontSize * sdfPos.height) / 42,\n          fontSize,\n        ],\n        texturePosition: [\n          sdfPos.x / this.sdfTextureWidth,\n          1 - sdfPos.y / this.sdfTextureHeight,\n          sdfPos.width / this.sdfTextureWidth,\n          -sdfPos.height / this.sdfTextureHeight,\n        ],\n      });\n      dx += sdfPos.xadvance * scale;\n    }\n    if (this.scene) this.scene.renderFrame();\n  }\n}\n\nfunction getTextProgram(gl, options) {\n  return defineProgram({\n    capacity: options.capacity || 1,\n    buffer: options.buffer,\n    debug: options.debug,\n    gl,\n    vertex: `\n  uniform mat4 modelViewProjection;\n  uniform vec4 color;\n  uniform float cameraDistance;\n\n  // Position of the text character:\n  attribute vec3 position;\n  // Instanced quad coordinate:\n  attribute vec2 point;\n  attribute vec3 charSize;\n  // [x, y, w, h] - of the character in the msdf texture;\n  attribute vec4 texturePosition;\n\n  varying vec4 vColor;\n  varying vec2 vPoint;\n\n  void main() {\n    gl_Position = modelViewProjection * vec4(position + vec3(vec2(point.x, point.y) * charSize.xy, position.z), 1.);\n    vPoint = texturePosition.xy + point * texturePosition.zw;\n    vColor = color;\n    vColor[3] *= (1. - smoothstep(0.0, 1., cameraDistance / (5000. * charSize.z)));\n  }`,\n\n    fragment: `\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\n  precision highp float;\n  varying vec2 vPoint;\n  varying vec4 vColor;\n\n  uniform float bias;\n  uniform float opacity;\n  uniform float cameraDistance;\n  uniform sampler2D msdf;\n\n  float median(float r, float g, float b) {\n    return max(min(r, g), min(max(r, g), b));\n  }\n\n  void main() {\n    vec3 sample = texture2D(msdf, vPoint).rgb;\n    float sigDist = median(sample.r, sample.g, sample.b) - bias;\n    float alpha = clamp(sigDist / fwidth(sigDist) + bias, 0.0, 1.0);\n    gl_FragColor = vec4(vColor.rgb, vColor.a * alpha * opacity);\n  }`,\n    instanced: {\n      point: new InstancedAttribute([\n        0, 0, \n        1, 0, \n        1, 1, \n\n        1, 1, \n        0, 0, \n        0, 1]),\n    },\n  });\n}\n","import { defineProgram, ColorAttribute, InstancedAttribute, GLCollection } from 'w-gl';\n\nexport default class ColoredTextCollection extends GLCollection {\n  constructor(gl, options = {}) {\n    gl.getExtension('OES_standard_derivatives');\n\n    super(getTextProgram(gl, options));\n\n    // TODO: this duplicates MSDFTextCollection. DRY it.\n    let img = (this.msdfImage = new Image());\n    img.crossOrigin = 'Anonymous';\n    this.isReady = false;\n    this.queue = [];\n    this.fontSize = options.fontSize || 2;\n    this.opacity = options.opacity !== undefined ? options.opacity : 1;\n    this.fontInfo = null;\n\n    let fontPath = 'fonts';\n    fetch(`${fontPath}/Roboto.json`, { mode: 'cors' })\n      .then((x) => x.json())\n      .then((fontInfo) => {\n        this.fontInfo = fontInfo;\n        this.alphabet = new Map();\n        fontInfo.chars.forEach((char) => {\n          let charValue = String.fromCharCode(char.id);\n          this.alphabet.set(charValue, char);\n        });\n\n        this.msdfImage.onload = () => {\n          this._sdfTextureChanged = true;\n          this.program.setTextureCanvas('msdf', this.msdfImage);\n          this.isReady = true;\n          this.sdfTextureWidth = img.width;\n          this.sdfTextureHeight = img.height;\n\n          this.queue.forEach((q) => this.addText(q));\n          this.queue = [];\n        };\n        this.msdfImage.src = `${fontPath}/Roboto0.png`;\n      });\n  }\n\n  clear() {\n    this.program.setCount(0);\n  }\n\n  draw(gl, drawContext) {\n    if (!this.uniforms) {\n      this.uniforms = {\n        modelViewProjection: this.modelViewProjection,\n        bias: 0.5,\n        opacity: this.opacity\n      };\n    }\n    this.uniforms.opacity = this.opacity;\n    this.uniforms.cameraDistance = drawContext.view.position[2];\n\n    this.uniforms.bias = 0.5;\n    this.program.draw(this.uniforms);\n  }\n\n  addText(textInfo) {\n    if (!this.isReady) {\n      this.queue.push(textInfo);\n      return;\n    }\n    let { text, x = 0, y = 0, z = 0 } = textInfo;\n    if (text === undefined) {\n      throw new Error('Text is not defined in ' + textInfo);\n    }\n    let dx = 0;\n    let fontSize = textInfo.fontSize || this.fontSize;\n    if (textInfo.limit !== undefined) {\n      let w = 0;\n      for (let char of text) {\n        let sdfPos = this.alphabet.get(char);\n        if (!sdfPos) continue;\n        w += sdfPos.xadvance;\n      }\n      fontSize = (textInfo.limit * this.fontInfo.info.size) / w;\n    }\n\n    let scale = fontSize / this.fontInfo.info.size;\n    if (textInfo.cx !== undefined) {\n      let w = 0;\n      for (let char of text) {\n        let sdfPos = this.alphabet.get(char);\n        if (!sdfPos) continue;\n\n        w += sdfPos.xadvance;\n      }\n      dx -= w * textInfo.cx * scale;\n    }\n    if (textInfo.cy !== undefined) {\n      y += fontSize * textInfo.cy;\n    }\n\n    for (let char of text) {\n      let sdfPos = this.alphabet.get(char);\n      if (!sdfPos) {\n        console.error(char + ' is missing in the font');\n        continue;\n      }\n\n      this.add({\n        position: [x + dx, y - sdfPos.yoffset * scale, z],\n        color: textInfo.color,\n        charSize: [\n          (fontSize * sdfPos.width) / 42,\n          (-fontSize * sdfPos.height) / 42,\n          fontSize\n        ],\n        texturePosition: [\n          sdfPos.x / this.sdfTextureWidth,\n          1 - sdfPos.y / this.sdfTextureHeight,\n          sdfPos.width / this.sdfTextureWidth,\n          -sdfPos.height / this.sdfTextureHeight,\n        ],\n      });\n      dx += sdfPos.xadvance * scale;\n    }\n    if (this.scene) this.scene.renderFrame();\n  }\n}\n\nfunction getTextProgram(gl, options) {\n  return defineProgram({\n    capacity: options.capacity || 1,\n    buffer: options.buffer,\n    debug: options.debug,\n    gl,\n    vertex: `\n  uniform mat4 modelViewProjection;\n  uniform float cameraDistance;\n\n  attribute vec4 color;\n\n  // Position of the text character:\n  attribute vec3 position;\n  // Instanced quad coordinate:\n  attribute vec2 point;\n  attribute vec3 charSize;\n  // [x, y, w, h] - of the character in the msdf texture;\n  attribute vec4 texturePosition;\n\n  varying vec2 vPoint;\n  varying vec4 vColor;\n\n  void main() {\n    gl_Position = modelViewProjection * vec4(\n      position + vec3(vec2(point.x, point.y) * charSize.xy, position.z), 1.);\n    vPoint = texturePosition.xy + point * texturePosition.zw;\n    vColor = color.abgr;\n    vColor[3] = smoothstep(0.2, 0.8, cameraDistance / (50. * charSize.z) );\n  }`,\n\n    fragment: `\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\n  precision highp float;\n  varying vec2 vPoint;\n  varying vec4 vColor;\n\n  uniform float bias;\n  uniform float opacity;\n  uniform sampler2D msdf;\n\n  float median(float r, float g, float b) {\n    return max(min(r, g), min(max(r, g), b));\n  }\n\n  void main() {\n    vec3 sample = texture2D(msdf, vPoint).rgb;\n    float sigDist = median(sample.r, sample.g, sample.b) - bias;\n    float alpha = clamp(sigDist / fwidth(sigDist) + bias, 0.0, 1.0);\n    gl_FragColor = vec4(vColor.rgb, vColor.a * alpha * opacity);\n  }`,\n    attributes: {\n      color: new ColorAttribute(),\n    },\n    instanced: {\n      point: new InstancedAttribute([0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 1]),\n    },\n  });\n}\n","const fuzzysort = require('fuzzysort')\n\nexport default function createFuzzySearcher() {\n  let words = [];\n  let lastPromise;\n  let api = {\n    addWord,\n    find\n  }\n\n  return api;\n\n  function addWord(word) {\n    words.push(word);\n  }\n\n  function find(query) {\n    if (lastPromise) {\n      lastPromise.cancel();\n    }\n    lastPromise = fuzzysort.goAsync(query, words, {limit: 10})\n\n    return lastPromise.then(results => {\n      return results.map(x => ({\n        html: fuzzysort.highlight(x, '<b>', '</b>'),\n        text: x.target\n      }));\n    }); \n    // if(invalidated) promise.cancel()\n  }\n}","let qs = require('query-state')\nlet state = qs.instance({}, {useSearch: true})\nlet pendingSave;\nlet versionToLink = {\n  1: 'https://anvaka.github.io/map-of-reddit-data/graph.svg',\n  2: 'https://anvaka.github.io/map-of-reddit-data/v2/graph.svg',\n  // 3: 'http://127.0.0.1:8080/graph.svg',\n};\n\nlet lastVersion = 2;\nlet latestGraphLink = versionToLink[lastVersion];\n// we should ignore camera position if user doesn't have graph version in the link\n// it means they have stored previous link, and we have changed the graph, so their\n// link wouldn't work correctly.\nlet versionMissing = state.get('v') === undefined;\nlet graphDefined = state.get('graph') !== undefined;\n\nexport default {\n  query: state.get('q') || '',\n  userTypedSomething: false,\n\n  getFilePath() {\n    const version = state.get('v')\n    return state.get('graph') || versionToLink[version] || latestGraphLink;\n  },\n  saveQuery(newQuery) {\n    // make sure we store the version in all new calls:\n    if (newQuery) {\n      const newState = {q: newQuery};\n      state.set(newState);\n    } else {\n      state.unset('q');\n    }\n  },\n  getQueryState() {\n    return state;\n  },\n  getCameraPosition() {\n    if (versionMissing && !graphDefined) return;\n    let coordinates = ['x', 'y', 'z'].map(name => {\n      let v = Number.parseFloat(state.get(name));\n      if (Number.isFinite(v)) return v;\n    }).filter(x => x !== undefined);\n    if (coordinates.length === 3) return coordinates;\n  },\n  saveScenePosition(scene) {\n    if (pendingSave) {\n      clearTimeout(pendingSave);\n      pendingSave = 0;\n    }\n\n    pendingSave = setTimeout(() => {\n      pendingSave = 0;\n      let dc = scene.getDrawContext();\n      let [x, y, z] = dc.view.position;\n      let position = {x, y, z}\n\n      if (versionMissing && !graphDefined) {\n        position.v = lastVersion;\n      }\n      state.set(position);\n    }, 300);\n  }\n}","export const Colors = {\n  PRIMARY_HIGHLIGHT_COLOR: 0xBF2172ff,\n  SECONDARY_HIGHLIGHT_COLOR: 0xE56BAAff,\n  TERNARY_COLOR: 0xdcdcdcff,\n  TERNARY_LINK: 0x88888844\n};\n\nexport const LayerLevels = {\n  Polygons: 0,\n  Edges: 5,\n  HighlightedEdges: 7,\n  Nodes: 10,\n  Labels: 12,\n  Text: 15\n}\n\nexport const NamedGroups = {\n  MainGraph: 'main-graph-view'\n}","import {GLCollection, defineProgram, InstancedAttribute, ColorAttribute} from 'w-gl';\n\n// Note: the shader has a bug with z coordinate of the arrow. I'm still keeping it and maybe will get back\n// to it later\nexport default class LineCollection extends GLCollection {\n    constructor(gl, options) {\n      let program = defineProgram({\n        gl,\n        vertex: `\nuniform mat4 modelViewProjection;\nuniform float width;\n\nattribute vec3 from, to;\nattribute vec2 point;\nattribute vec4 color;\nvarying vec2 vPoint;\nvarying vec4 vColor;\n\nvoid main() {\n  vec2 xBasis = normalize(to - from).xy;\n  vec2 yBasis = vec2(-xBasis.y, xBasis.x);\n  vec4 clip0 = modelViewProjection * vec4(from.xy + width * yBasis * point.x, from.z, 1.0);\n  vec4 clip1 = modelViewProjection * vec4(to.xy + width * yBasis * point.x, to.z, 1.0);\n  gl_Position = mix(clip0, clip1, point.y);\n  vColor = color;\n}`,\n\n        fragment: `\n    precision highp float;\n    varying vec4 vColor;\n\n    void main() {\n      gl_FragColor = vColor.abgr;\n    }`,\n      attributes: {\n        color: new ColorAttribute(),\n      },\n      instanced: {\n          point: new InstancedAttribute([\n            -0.5, 0, -0.5, 1, 0.5, 1, // First 2D triangle of the quad\n            -0.5, 0, 0.5, 1, 0.5, 0   // Second 2D triangle of the quad\n          ])\n        }\n      });\n      super(program);\n      this.width = (options && options.width) || 1;\n    }\n\n    draw() {\n      if (!this.uniforms) {\n        this.uniforms = {\n          modelViewProjection: this.modelViewProjection,\n          width: this.width,\n        }\n      }\n      this.uniforms.width = this.width;\n      this.program.draw(this.uniforms);\n    }\n    // add(line) {\n    //   if (line.width === undefined) line.width = this.width;\n    //   super.add(line);\n    // }\n\n    clear() {\n      this.program.setCount(0);\n    }\n  }","/**\n * This class is responsible for finding nodes under cursor\n */\nimport RBush from 'rbush';\nimport knn from 'rbush-knn';\nimport bus from './bus';\nimport LineCollection from './LineCollection';\nimport PointCollection from './PointCollection';\nimport {LayerLevels} from './constants';\n\nexport default function createPointerEventsHandler(sceneLayerManager, options) {\n  const spatialIndex = new RBush();\n  let moved = false;\n  let isPaused = false;\n  let maxCameraDistance = 8000;\n  const scene = sceneLayerManager.getScene();\n\n  scene.on('click', handleClick);\n  scene.on('mousemove', handleMove);\n  scene.on('transform', handleTransform);\n\n  const highlightedNodes = new PointCollection(scene.getGL());\n  let primaryWidth = getPrimaryLineWidth(scene.getDrawContext().view.position[2]);\n  const firstLevelArrows = new LineCollection(scene.getGL(), {width: primaryWidth});\n  const secondLevelArrows = new LineCollection(scene.getGL(), {width: primaryWidth/2});\n\n  sceneLayerManager.addToLayer(secondLevelArrows, LayerLevels.Edges);\n  sceneLayerManager.addToLayer(firstLevelArrows, LayerLevels.HighlightedEdges);\n  sceneLayerManager.addToLayer(highlightedNodes, LayerLevels.Nodes);\n\n  if (options.elementsGroupName) {\n    sceneLayerManager.addToNamedGroup(firstLevelArrows, options.elementsGroupName);\n    sceneLayerManager.addToNamedGroup(secondLevelArrows, options.elementsGroupName);\n    sceneLayerManager.addToNamedGroup(highlightedNodes, options.elementsGroupName);\n  }\n\n  return {\n    addNode,\n    clearHighlights,\n    focusUI,\n    dispose,\n    setPaused,\n    getIndex() {\n      return spatialIndex;\n    },\n    setViewBox\n  }\n\n  function setViewBox(newBox) {\n    maxCameraDistance = Math.max(newBox.width, newBox.height);\n  }\n\n  function handleTransform(e) {\n    if (isPaused) return;\n    let cameraZPosition = e.drawContext.view.position[2];\n    firstLevelArrows.width = getPrimaryLineWidth(cameraZPosition);\n    secondLevelArrows.width = firstLevelArrows.width / 2;\n    moved = true;\n    if (options && options.onTransform) options.onTransform();\n  }\n\n  function getPrimaryLineWidth(cameraZPosition) {\n    const k = cameraZPosition / maxCameraDistance;\n    let pixelWidth = 6 - 2 * k;\n    if (k < 0) pixelWidth = 5;\n    if (k > 2) pixelWidth = Math.log(k) / Math.log(2) + 1;\n    return getSceneWidthForPixelWidth(pixelWidth/8)\n  }\n\n  function getSceneWidthForPixelWidth(pixelWidth) {\n    let dc = scene.getDrawContext();\n    let top = scene.getSceneCoordinate(dc.width / 2, dc.height / 2 - pixelWidth / 2);\n    let bottom = scene.getSceneCoordinate(dc.width / 2, dc.height / 2 + pixelWidth / 2);\n    return Math.abs(top[1] - bottom[1]);\n  }\n\n  function clearHighlights() {\n    firstLevelArrows.clear();\n    secondLevelArrows.clear();\n    highlightedNodes.clear();\n  }\n\n  function focusUI(ui) {\n    if (ui !== undefined) {\n      bus.fire('show-subreddit', ui.name);\n    }\n    let graph = options && options.getGraph && options.getGraph();\n    if (!ui && !moved && graph) {\n      clearHighlights();\n      bus.fire('show-subreddit', null);\n      scene.renderFrame();\n    }\n\n    moved = false;\n\n    if (ui) {\n      clearHighlights();\n\n      options.getHighlightedLinks(ui).forEach(linkUI => {\n        let links = linkUI.isFirstLevel ? firstLevelArrows : secondLevelArrows;\n        links.add(linkUI);\n      });\n      options.getHighlightedNodes(ui).forEach(nodeUI => highlightedNodes.add(nodeUI));\n\n      scene.renderFrame();\n    } \n  }\n\n  function addNode(ui) {\n    let position = ui.position;\n    let r = ui.size / 2;\n\n    spatialIndex.insert({\n      minX: position[0] - r,\n      minY: position[1] - r,\n      maxX: position[0] + r,\n      maxY: position[1] + r,\n      ui,\n    });\n  }\n\n  function dispose() {\n    scene.removeChild(firstLevelArrows);\n    scene.removeChild(secondLevelArrows);\n    scene.removeChild(highlightedNodes);\n\n    scene.off('click', handleClick);\n    scene.off('mousemove', handleMove);\n    scene.off('transform', handleTransform);\n  }\n\n  function handleClick(e) {\n    let ui = findNearest(e.x, e.y);\n    focusUI(ui);\n  }\n\n  function setPaused(newIsPaused) {\n    isPaused = newIsPaused;\n  }\n\n  function handleMove(e) {\n    if (isPaused) return;\n\n    let ui = findNearest(e.x, e.y);\n    if (ui !== undefined) {\n      bus.fire('show-tooltip', {\n        x: e.originalEvent.clientX,\n        y: e.originalEvent.clientY,\n        data: ui.name,\n      });\n      return;\n    }\n\n    bus.fire('show-tooltip', null);\n  }\n\n  function findNearest(x, y) {\n    const neighborIds = knn(spatialIndex, x, y, 1);\n    let neighbor = neighborIds[0];\n    if (neighbor === undefined) return;\n    let ui = neighbor.ui;\n\n    let [uiX, uiY] = ui.position;\n    let dist = Math.hypot(x - uiX, y - uiY);\n    if (dist < ui.size / 2) return ui;\n  }\n}","export default function getComplimentaryColor(color, lightningFactor = 1.4, alpha = 0xaa) {\n  let r = (color >> 24) & 0xff;\n  let g = (color >> 16) & 0xff;\n  let b = (color >> 8) & 0xff;\n  let [h, s, l] = rgbToHsl(r, g, b);\n  if (l > 0.5) lightningFactor = .8;\n  let [r0, g0, b0] = hslToRgb(h, s, Math.min(1, l * lightningFactor));\n  return (r0 << 24) | (g0 << 16) | (b0 << 8) | alpha;\n}\n\nfunction rgbToHsl(r, g, b) {\n  r /= 255, g /= 255, b /= 255;\n\n  var max = Math.max(r, g, b), min = Math.min(r, g, b);\n  var h, s, l = (max + min) / 2;\n\n  if (max == min) {\n    h = s = 0; // achromatic\n  } else {\n    var d = max - min;\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n\n    switch (max) {\n      case r: h = (g - b) / d + (g < b ? 6 : 0); break;\n      case g: h = (b - r) / d + 2; break;\n      case b: h = (r - g) / d + 4; break;\n    }\n\n    h /= 6;\n  }\n\n  return [ h, s, l ];\n}\n\nfunction hslToRgb(h, s, l) {\n  var r, g, b;\n\n  if (s == 0) {\n    r = g = b = l; // achromatic\n  } else {\n    var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    var p = 2 * l - q;\n\n    r = hue2rgb(p, q, h + 1/3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1/3);\n  }\n\n  return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];\n}\n\nfunction hue2rgb(p, q, t) {\n  if (t < 0) t += 1;\n  if (t > 1) t -= 1;\n  if (t < 1/6) return p + (q - p) * 6 * t;\n  if (t < 1/2) return q;\n  if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;\n  return p;\n}","import PointCollection from './PointCollection';\nimport TextCollection from './MSDFTextCollection';\nimport PolyLineCollection from './PolyLineCollection';\nimport {Colors, LayerLevels, NamedGroups} from './constants';\nimport createPointerEventsHandler from './createPointerEventsHandler';\nimport bus, {setProgress} from './bus';\nimport getComplimentaryColor from './getComplimentaryColor';\n\nconst createLayout = require('ngraph.forcelayout');\nconst FLOOR_COLOR = 0x5670B6ff;\nconst EDGE_COLOR = getComplimentaryColor(0x5670B6ff);\n\nconst Easing = {\n  easeInQuart(x) {\n    return x * x * x * x;\n  }\n}\n\nexport default function createSubgraphVisualizer(subgraph, viewBox, sceneLayerManager, nodeNameToUI) {\n  let layout;\n  let raf;\n  let MAX_FRAMES = 4000;\n  let renderCount = 0;\n  let moveThreshold = 0.1;\n  let prevSize = 0;\n\n  const ourNodeNameToUI = new Map();\n  const scene = sceneLayerManager.getScene();\n  const points = new PointCollection(scene.getGL());\n  const text = new TextCollection(scene.getGL());\n  const boundariesFill = new PolyLineCollection(scene.getGL(), {color: 0x124182a4, opacity: 1.0});\n  const transitionAnimator = createTransitionAnimator(sceneLayerManager, 60 * 0.2, viewBox);\n\n  // order is important. Pointer events should go after main elements\n  sceneLayerManager.addToLayer(boundariesFill, LayerLevels.Polygons);\n  sceneLayerManager.addToLayer(points, LayerLevels.Nodes);\n  sceneLayerManager.addToLayer(text, LayerLevels.Text);\n\n  // Now we are going to listen to events from the subgraph:\n  let pointerEvents = createPointerEventsHandler(sceneLayerManager, {\n    getGraph: () => renderCount < MAX_FRAMES && subgraph,\n    getHighlightedLinks,\n    getHighlightedNodes\n  });\n  bus.on('subgraph-focus-node', focusSubgraphNode);\n\n  return {\n    dispose,\n    getPointerEvents() {\n      return pointerEvents\n    },\n    getNameToUI() {\n      return ourNodeNameToUI\n    },\n    run\n  };\n\n\n  function focusSubgraphNode(name) {\n    pointerEvents.focusUI(ourNodeNameToUI.get(name));\n  }\n\n  function getHighlightedNodes(ui) {\n    const hlNode = {...ourNodeNameToUI.get(ui.name)};\n    hlNode.color = Colors.PRIMARY_HIGHLIGHT_COLOR ;\n    let nodeUIs = [hlNode];\n    subgraph.forEachLinkedNode(ui.name, (other) => {\n      const hlNode = {...ourNodeNameToUI.get(other.id)};\n      hlNode.color = Colors.SECONDARY_HIGHLIGHT_COLOR;\n      nodeUIs.push(hlNode);\n    });\n\n    return nodeUIs;\n  }\n\n  function getHighlightedLinks(ui) {\n    let linkUIs = [];\n\n    subgraph.forEachLink(link => {\n      let isFirstLevel = (link.fromId === ui.name || link.toId === ui.name);\n      linkUIs.push({\n        from: ourNodeNameToUI.get(link.fromId).position,\n        to: ourNodeNameToUI.get(link.toId).position,\n        color: isFirstLevel ? 0xffffffff : EDGE_COLOR, \n        isFirstLevel\n      });\n    });\n\n    return linkUIs;\n  }\n\n  function dispose(onSceneIsBack) {\n    cancelAnimationFrame(raf);\n    bus.off('subgraph-focus-node', focusSubgraphNode);\n\n    text.parent.removeChild(text);\n    text.dispose();\n\n    pointerEvents.dispose();\n\n    transitionAnimator.startSceneRestoration(() => {\n      boundariesFill.parent.removeChild(boundariesFill);\n      points.parent.removeChild(points);\n      points.dispose();\n      if (onSceneIsBack) onSceneIsBack();\n    }, ourNodeNameToUI, nodeNameToUI, points, onSceneIsBack === undefined);\n    raf = null;\n    scene.renderFrame();\n  }\n\n  function run() {\n    transitionAnimator.startFadeOut();\n    beginLayout();\n    // transitionAnimator.startZoomOut(beginLayout);\n  }\n\n  function beginLayout() {\n    let minSize = Infinity;\n    let maxSize = -Infinity;\n    subgraph.forEachNode(node => {\n      let ui = nodeNameToUI.get(node.id);\n      if (!ui) throw new Error('Missing ui for node: ' + node.id);\n      if (ui.size < minSize) minSize = ui.size;\n      if (ui.size > maxSize) maxSize = ui.size;\n    });\n    moveThreshold = maxSize * 0.5;\n\n    layout = createLayout(subgraph, {\n      timeStep: maxSize / 20,\n      springLength: maxSize * 3,\n      springCoefficient: 1e-4,\n      gravity: -maxSize*100,\n      nodeMass(nodeId) {\n        let ui = nodeNameToUI.get(nodeId);\n        return ui.size;\n      }\n    });\n\n    rememberAndSetOriginalPositions();\n    raf = requestAnimationFrame(frame);\n  }\n\n  function frame() {\n    for (let i = 0; i < 10; ++i) layout.step();\n\n    let bboxSize = updateNodePositions();\n    let movedLength = Math.abs(prevSize - bboxSize);\n    prevSize = bboxSize;\n\n    if (movedLength > moveThreshold && renderCount++ < MAX_FRAMES) {\n      raf = requestAnimationFrame(frame);\n      if (renderCount % 10 === 0) {\n        setProgress(() => ({\n          message: `Layout step ${renderCount} of ${MAX_FRAMES}. Please wait...`\n        }));\n      }\n    } else {\n      finishRendering();\n    }\n\n    scene.setViewBox(getBoundingRect());\n\n    scene.renderFrame();\n  }\n\n  function getRootNodeId() {\n    let root = null;\n    subgraph.forEachNode(node => {\n      if (node.data && node.data.isRoot) {\n        root = node.id;\n        return true;\n      }\n    });\n    if (!root) {\n      throw new Error('Root node is missing in the subgraph');\n    }\n    return root;\n  }\n\n  function finishRendering() {\n    let points = [];\n    subgraph.forEachNode(node => {\n      let {x, y} = layout.getNodePosition(node.id);\n      points.push([x, y]);\n      let ui = ourNodeNameToUI.get(node.id);\n      pointerEvents.addNode(ui);\n      text.addText({\n        x,\n        y: y - ui.size * 0.75,\n        text: ui.name,\n        limit: 2. * ui.size,\n        cx: 0.5,\n      });\n    });\n\n    let rootNode = getRootNodeId();\n    pointerEvents.focusUI(ourNodeNameToUI.get(rootNode));\n    setProgress(() => ({\n      subgraphDone: true,\n      subgraphName: rootNode\n    }));\n    import('concaveman').then(concaveman => {\n      var polygon = concaveman.default(points);\n      boundariesFill.addPolygon({polygon, color: FLOOR_COLOR})\n      scene.renderFrame();\n    })\n  }\n\n  function getBoundingRect() {\n    let boundingRect = {\n      left: Infinity,\n      right: -Infinity,\n      top: Infinity,\n      bottom: -Infinity\n    }\n    subgraph.forEachNode(node => {\n      let {x, y} = layout.getNodePosition(node.id);\n      if (x < boundingRect.left) boundingRect.left = x;\n      if (x > boundingRect.right) boundingRect.right = x;\n      if (y < boundingRect.top) boundingRect.top = y;\n      if (y > boundingRect.bottom) boundingRect.bottom = y;\n    });\n    return boundingRect;\n  }\n\n  function updateNodePositions() {\n    let minX = Infinity;\n    let maxX = -Infinity;\n    let minY = Infinity;\n    let maxY = -Infinity;\n\n    subgraph.forEachNode(node => {\n      let pos = layout.getNodePosition(node.id);\n      let ui = ourNodeNameToUI.get(node.id);\n\n      ui.position[0] = pos.x;\n      ui.position[1] = pos.y;\n      if (pos.x < minX) minX = pos.x;\n      if (pos.x > maxX) maxX = pos.x;\n      if (pos.y < minY) minY = pos.y;\n      if (pos.y > maxY) maxY = pos.y;\n      points.update(ui.id, ui);\n    });\n    let w = maxX - minX;\n    let h = maxY - minY;\n    return w * h;\n  }\n\n  function rememberAndSetOriginalPositions() {\n    let minSize = Infinity;\n    let maxSize = -Infinity;\n    subgraph.forEachNode(node => {\n      let ui = nodeNameToUI.get(node.id);\n      if (!ui) throw new Error('Missing ui for node: ' + node.id);\n      // let isRoot = node.data && node.data.isRoot;\n      let pos = copyPosition(ui.position);\n      let color = Colors.TERNARY_COLOR;\n      // if (isRoot) color = Colors.PRIMARY_HIGHLIGHT_COLOR;\n      // else if (node.data && node.data.isFirstChild) color = Colors.SECONDARY_HIGHLIGHT_COLOR;\n\n      let ourUI = {\n        position: pos,\n        color,\n        size: ui.size,\n        id: ourNodeNameToUI.size,\n        name: ui.name,\n      };\n      if (ourUI.size < minSize) minSize = ourUI.size;\n      if (ourUI.size > maxSize) maxSize = ourUI.size;\n      ourNodeNameToUI.set(ui.name, ourUI);\n      points.add(ourUI);\n      layout.setNodePosition(node.id, pos[0], pos[1])\n    });\n  }\n\n}\n\nfunction createTransitionAnimator(sceneLayerManager, durationInFrames, zoomOutViewBox) {\n  let elapsed = 0;\n  let raf;\n  let currentStep;\n  let zoomStart, zoomEnd, changeRectangleFinishedCallback;\n  let doneCallback;\n  let positions, nodeUIs;\n  const scene = sceneLayerManager.getScene();\n\n  return {\n    startZoomOut,\n    startZoomIn,\n    startFadeOut,\n    startSceneRestoration,\n    dispose() {\n      cancelAnimationFrame(raf);\n    }\n  }\n\n  function startZoomOut(cb) {\n    elapsed = 0;\n    zoomStart = getCurrentBoundingRectangle();\n    let {width, height, top, left} = zoomOutViewBox;\n    zoomEnd = {\n      top, \n      left,\n      right: left + width,\n      bottom: top + height\n    };\n\n    currentStep = changeRectangle;\n    changeRectangleFinishedCallback = () => {\n      startFadeOut();\n      cb();\n    };\n\n    cancelAnimationFrame(raf);\n    raf = requestAnimationFrame(frame);\n  }\n\n  function startZoomIn(boundingRect, doneCallback) {\n    currentStep = changeRectangle;\n    elapsed = 0;\n    zoomStart = getCurrentBoundingRectangle();\n    zoomEnd = boundingRect;\n    cancelAnimationFrame(raf);\n    raf = requestAnimationFrame(frame);\n    changeRectangleFinishedCallback = null;\n    if (doneCallback) {\n      changeRectangleFinishedCallback = doneCallback;\n    }\n  }\n\n  function getCurrentBoundingRectangle() {\n    let dc = scene.getDrawContext();\n    const {position} = dc.view;\n    let side = position[2] * Math.tan(dc.fov / 2) / dc.pixelRatio;\n    return {\n      left: position[0] - side, \n      right: position[0] + side, \n      top: position[1] - side, \n      bottom: position[1] + side\n    };\n  }\n\n  function startFadeOut() {\n    sceneLayerManager.getNamedGroup(NamedGroups.MainGraph).elements.forEach(el => {\n      el.opacity = 0;\n    });\n    sceneLayerManager.hideNamedGroup(NamedGroups.MainGraph);\n  }\n\n  function startSceneRestoration(done, current, target, nodeCollections, immediate) {\n    if (immediate) {\n      // TODO: this is ugly. Please refactor.\n      sceneLayerManager.restoreNamedGroup(NamedGroups.MainGraph);\n      sceneLayerManager.getNamedGroup(NamedGroups.MainGraph).elements.forEach(el => {\n        el.opacity = 1;\n      });\n      done();\n      return;\n    }\n    elapsed = 0;\n    currentStep = fadeIn;\n    cancelAnimationFrame(raf);\n    raf = requestAnimationFrame(frame);\n    doneCallback = done;\n\n    nodeUIs = nodeCollections;\n    positions = [];\n    current.forEach((ui, name) => {\n      positions.push({\n        ui,\n        from: copyPosition(ui.position),\n        to: target.get(name).position\n      });\n    })\n  }\n\n  function frame() {\n    if (elapsed >= durationInFrames) {\n      elapsed = durationInFrames;\n      currentStep(1);\n      return;\n    } \n\n    raf = requestAnimationFrame(frame);\n    currentStep(elapsed / durationInFrames);\n    elapsed += 1;\n  }\n\n  function changeRectangle(x) {\n    if (x === 1) {\n      if (changeRectangleFinishedCallback) changeRectangleFinishedCallback();\n      changeRectangleFinishedCallback = null;\n      return;\n    }\n\n    scene.setViewBox({\n      top: lerp(zoomStart.top, zoomEnd.top, x),\n      left: lerp(zoomStart.left, zoomEnd.left, x),\n      right: lerp(zoomStart.right, zoomEnd.right, x),\n      bottom: lerp(zoomStart.bottom, zoomEnd.bottom, x)\n    });\n    scene.renderFrame();\n  }\n\n  function lerp(from, to, t) {\n    return to * t + from * (1 - t);\n  }\n\n  function fadeIn(x) {\n    if (x === 0) {\n      // we we just start - let's bring back all nodes from original scene\n      // Their opacity is 0.\n      sceneLayerManager.restoreNamedGroup(NamedGroups.MainGraph);\n    }\n    // we will be changing opacity back to normal:\n    let opacity = Easing.easeInQuart(x);\n    sceneLayerManager.getNamedGroup(NamedGroups.MainGraph).elements.forEach(el => {\n      el.opacity = opacity;\n    });\n    positions.forEach(node => {\n      let ui = node.ui;\n      ui.position[0] = lerp(node.from[0], node.to[0], x);\n      ui.position[1] = lerp(node.from[1], node.to[1], x);\n      nodeUIs.update(ui.id, ui);\n    });\n    sceneLayerManager.getScene().renderFrame();\n\n    if (x === 1 && doneCallback) {\n      // all is done, let's notify the client\n      doneCallback();\n    }\n  }\n}\n\nfunction copyPosition(pos) {\n  return [pos[0], pos[1], pos[2]];\n}","export default function createSceneLayerManager(scene) {\n  // Allows clients to hide/restore multiple elements at once:\n  const namedGroups = new Map(); // string -> {elements: Element[], isHidden: Boolean}\n\n  return {\n    addToLayer,\n    addToNamedGroup,\n    hideNamedGroup,\n    restoreNamedGroup,\n    getNamedGroup: (groupName) => namedGroups.get(groupName),\n    getScene: () => scene\n  };\n\n  function restoreNamedGroup(groupName) {\n    let group = namedGroups.get(groupName);\n    if (group === undefined) throw new Error('No such group: ' + groupName);\n    if (!group.isHidden) return; // already restored\n    group.isHidden = false;\n    group.elements.forEach(element => {\n      // put it back to the previous z-index\n      addToLayer(element, element.layer);\n    });\n  }\n\n  function addToNamedGroup(element, groupName) {\n    let group = namedGroups.get(groupName);\n    if (group === undefined) {\n      group = {\n        elements: [],\n        isHidden: false\n      }\n      namedGroups.set(groupName, group);\n    }\n    // Note: it's your responsibility to avoid duplicates\n    group.elements.push(element);\n  }\n\n  function hideNamedGroup(groupName) {\n    let group = namedGroups.get(groupName);\n    if (!group) {\n      throw new Error('No group with such name: ' + groupName);\n    }\n\n    if (group.isHidden) return; // already hidden;\n    group.isHidden = true;\n    group.elements.forEach(element => {\n      if (element.parent) element.parent.removeChild(element);\n    });\n  }\n\n  function addToLayer(element, layerIndex) {\n    element.layer = layerIndex\n    let rootElement = scene.getRoot();\n    let lastElementWithLowerLayerIndex = null;\n    rootElement.children.forEach(el => {\n      let layer = el.layer;\n      if (layer === undefined) {\n        // z-index may not be correct!\n        console.warn('Scene element without layer index', layer);\n        layer = 0;\n      }\n      if (layer <= layerIndex) {\n        lastElementWithLowerLayerIndex = el;\n      }\n    });\n    if (lastElementWithLowerLayerIndex) {\n      rootElement.insertChildAfter(element, lastElementWithLowerLayerIndex);\n    } else {\n      // none of the existing layers is lower than our own layer index,\n      // send us to the very back:\n      rootElement.appendChild(element, /* sendToBack */ true);\n    }\n  }\n}","import {GLCollection, defineProgram, ColorAttribute} from 'w-gl';\n\nconst tex = [\n  [0, 0],\n  [1, 0],\n  [1, 1],\n  [1, 1],\n  [0, 1],\n  [0, 0]\n]\nexport class BoxCollection extends GLCollection {\n  constructor(gl, options) {\n    let program = defineProgram({\n      gl,\n      capacity: options.capacity,\n      vertex: `\n  uniform mat4 modelViewProjection;\n  attribute vec3 point;\n  attribute vec2 texCoordinate;\n  attribute vec4 color;\n  varying vec3 vPoint;\n  varying vec2 vTex;\n  varying vec4 vColor;\n\n  void main() {\n    vec4 pos = modelViewProjection * vec4(point, 1.0);\n    gl_Position = pos;\n    vPoint = point;\n    vTex = texCoordinate;\n    vColor = color.abgr;\n  }`,\n\n      fragment: `\n      precision highp float;\n      uniform vec3 camera;\n      varying vec3 vPoint;\n      varying vec2 vTex;\n      varying vec4 vColor;\n\n      void main() {\n        vec4 col = vec4(0);\n        col += length(smoothstep(0.48, 0.5, abs(vTex - 0.5)));\n        col += vColor;\n        col[3] = 0.7;\n        gl_FragColor = col;\n      }`,\n\n        attributes: {\n          color: new ColorAttribute(),\n        },\n        preDrawHook(/* programInfo */) {\n          return `\n          // gl.disable(gl.BLEND);\n          gl.enable(gl.DEPTH_TEST);\n          gl.depthFunc(gl.LEQUAL);\n          `;\n        },\n        postDrawHook() {\n          return `\n          //gl.enable(gl.BLEND);\n           gl.disable(gl.DEPTH_TEST);\n           `;\n        },\n    });\n    super(program);\n\n    this.uiIDToUI = new Map();\n  }\n\n  draw(gl, drawContext) {\n    if (!this.uniforms) {\n      this.uniforms = {\n        modelViewProjection: this.modelViewProjection,\n        camera: drawContext.view.position\n      };\n    }\n    this.uniforms.opacity = this.opacity;\n    this.program.draw(this.uniforms);\n  }\n\n  setColor(box, color){\n    this.setFaceColor(box.front, color);\n    this.setFaceColor(box.left, color);\n    this.setFaceColor(box.right, color);\n    this.setFaceColor(box.back, color);\n  }\n\n  setFaceColor(face, color) {\n    face.forEach(point => {\n      point.color = color;\n      this.update(point.uiId, point);\n    })\n  }\n\n  addBox(box) {\n    let frontUI, leftUI, rightUI, backUI, topUI;\n    let front = this.getFace(box.width, box.height);\n    this.rotateFace(front, Math.PI/2, 'x')\n    this.translateFace(front, [0, 0, box.height/2]);\n    this.rotateFace(front, Math.PI/2, 'z')\n    this.translateFace(front, [box.x+box.width/2,box.y, 0]);\n    //this.translateFace(front, [box.x, box.y, 0]);\n    frontUI = this.addFace(front);\n    frontUI.name = 'front';\n\n    let left = this.getFace(box.width, box.height);\n    this.rotateFace(left, Math.PI/2, 'x')\n    this.translateFace(left, [0, 0, box.height / 2]);\n    this.translateFace(left, [0, -box.width/2, 0]);\n    this.translateFace(left, [box.x, box.y, 0]);\n    leftUI = this.addFace(left);\n    leftUI.name = 'left';\n\n    let right = this.getFace(box.width, box.height);\n    this.rotateFace(right, Math.PI/2, 'x')\n    this.translateFace(right, [0, 0, box.height / 2]);\n    this.rotateFace(right, Math.PI, 'z')\n    this.translateFace(right, [0, box.width/2, 0]);\n    this.translateFace(right, [box.x, box.y, 0]);\n    rightUI = this.addFace(right);\n    rightUI.name = 'right';\n\n    let back = this.getFace(box.width, box.height);\n    this.rotateFace(back, Math.PI/2, 'x')\n    this.translateFace(back, [0, 0, box.height/2]);\n    this.rotateFace(back, -Math.PI/2, 'z')\n    this.translateFace(back, [-box.width/2,0, 0]);\n    this.translateFace(back, [box.x, box.y, 0]);\n    backUI = this.addFace(back);\n    backUI.name = 'back';\n\n    let top = this.getFace(box.width, box.width);\n    this.translateFace(top, [box.x, box.y, box.height]);\n    topUI = this.addFace(top);\n\n    return {\n      front: frontUI,\n      left: leftUI,\n      right: rightUI,\n      back: backUI,\n      top: topUI\n    }\n  }\n\n  removeBox(box) {\n    this.removeFace(box.front);\n    this.removeFace(box.left);\n    this.removeFace(box.right);\n    this.removeFace(box.back);\n  }\n\n  translateFace(face, d) {\n    face.forEach(point => {\n      point[0] += d[0];\n      point[1] += d[1];\n      point[2] += d[2];\n    });\n  }\n\n  rotateFace(face, angle, axis) {\n    let c = Math.cos(angle), s = Math.sin(angle);\n    face.forEach(point => {\n      let [x, y, z] = point;\n      let x0, y0, z0;\n      if (axis === 'z') {\n        x0 = c * x - s * y;\n        y0 = s * x + c * y;\n        z0 = z;\n      } else if (axis === 'y') {\n        x0 = x * c + z * s;\n        y0 = y;\n        z0 = -x * s + z * c;\n      }  else if (axis === 'x') {\n        x0 = x;\n        y0 = y * c - z * s;\n        z0 = y * s + z * c;\n      } else {\n        throw new Error('Not supported axis ' + axis);\n      }\n      point[0] = x0;\n      point[1] = y0;\n      point[2] = z0;\n    })\n  }\n\n  getFace(width, height) {\n    return [\n      [ - width/2, - height/2, 0], // (0, 0)\n      [ + width/2, - height/2, 0], // (1, 0)\n      [ + width/2, + height/2, 0], // (1, 1)\n\n      [ + width/2, + height/2, 0], // (1, 1)\n      [ - width/2, + height/2, 0], // (0, 1)\n      [ - width/2, - height/2, 0], // (0, 0)\n    ];\n  }\n\n  addFace(quadPoints) {\n    return quadPoints.map((point, i) => {\n      let ui = {\n        point,\n        uiId: -1,\n        color: 0x292C33ff,\n        texCoordinate: tex[i]\n      };\n      ui.uiId = this.add(ui);\n      this.uiIDToUI.set(ui.uiId, ui);\n      return ui;\n    })\n  }\n\n  removeFace(quadUI) {\n    quadUI.forEach(ui => {\n      let oldId = ui.uiId;\n      let newId = this.remove(oldId);\n      let movedUI = this.uiIDToUI.get(newId);\n      if(!movedUI) {\n        throw new Error(\"Missing ui element\");\n      }\n      this.uiIDToUI.delete(newId);\n      if (newId !== oldId) {\n        movedUI.uiId = oldId;\n        this.uiIDToUI.set(oldId, movedUI);\n      }\n    })\n  }\n\n  clear() {\n    throw new Error('Not implemented');\n  }\n}\n","import { fpsControls, mapControls, createFPSControlsUI, DomElement, DomContainer } from 'w-gl';\nimport { BoxCollection } from './BoxCollection';\nimport {quat, mat4, vec3} from 'gl-matrix';\nimport knn from 'rbush-knn';\nimport bus, { setProgress } from './bus';\nimport { formatNumber } from './utils';\n\nexport default function createStreetView(scene, spatialIndex, nameToUI, subreddit, viewBox) {\n  let api = {\n    enter, \n    exit, \n    dispose,\n    lookAt\n  };\n  let fpsUI;\n  let boxes, items, asyncRender;\n  let visibleBoxes = new Set();\n  let visibilityUpdate = 0;\n  let uiToBox = new Map();\n  let visibleElements = new Map();\n  let lastVisibilityUpdate = 0;\n  let domContainer = new DomContainer({seeThrough: true});\n\n  return api;\n\n  function lookAt(name) {\n    let node = nameToUI.get(name);\n    if (!node) return;\n\n    let [x, y] = node.position;\n    let size = node.size || 10;\n    let a = Math.tan(scene.getDrawContext().fov/2);\n    let cameraController = scene.getCameraController();\n    cameraController.lookAt(\n      [x, y - 2*size/a, 4],\n      [x, y, size], \n    );\n  }\n\n  function dispose() {\n    cancelAnimationFrame(asyncRender);\n    asyncRender = 0;\n    clearTimeout(visibilityUpdate);\n    scene.removeChild(boxes);\n    scene.removeChild(domContainer);\n  }\n\n  function enter() {\n    let cameraController = scene.setCameraController(fpsControls);\n    lookAt(subreddit);\n\n    let minDimension = Math.min(viewBox.width, viewBox.height);\n    let moveSpeed = minDimension / 100000;\n    if (!Number.isFinite(moveSpeed)) moveSpeed = 0.1;\n\n    cameraController.setMoveSpeed(moveSpeed).setScrollSpeed(moveSpeed * 10).setFlySpeed(moveSpeed / 5).enableMouseCapture(true);\n    fpsUI = createFPSControlsUI(document.body, cameraController);\n\n    items = spatialIndex.all();\n    boxes = new BoxCollection(scene.getGL(), {\n      capacity: items.length * 5 * 6\n    });\n    scene.appendChild(boxes);\n    scene.appendChild(domContainer);\n\n    renderFirstBatch(subreddit);\n    scheduleVisibilityUpdate();\n  }\n\n  function renderFirstBatch(name) {\n    let node = nameToUI.get(name);\n    if (!node) return;\n\n    let [x, y] = node.position;\n    let neighbors = knn(spatialIndex, x, y, 60);\n    neighbors.forEach(item => {\n      let ui = item.ui;\n      let [x, y] = ui.position;\n      let box = boxes.addBox({\n        x, y,\n        width: ui.size,\n        height: ui.size * 2\n      });\n      uiToBox.set(ui, box);\n    });\n\n    renderTheRest();\n  }\n\n  function renderTheRest() {\n    let index = 0;\n    asyncRender = requestAnimationFrame(processNext);\n\n    function processNext() {\n      let localCount = 0;\n      while (index < items.length && localCount < 1000) {\n        let item = items[index];\n        let ui = item.ui;\n        index += 1;\n\n        if (uiToBox.has(ui)) continue; // processed in the first batch;\n\n        let [x, y] = ui.position;\n        let box = boxes.addBox({\n          x, y,\n          width: ui.size,\n          height: ui.size * 2\n        });\n        uiToBox.set(ui, box);\n        localCount += 1;\n      }\n\n      scene.renderFrame();\n\n      if (index < items.length) {\n        setProgress(() => ({\n          message: 'Initializing street view: ' + formatNumber(index) + '/' + formatNumber(items.length)\n        }));\n        asyncRender = requestAnimationFrame(processNext);\n      } else {\n        // all rendered!\n        setProgress(() => ({\n          streetViewDone: true,\n        }));\n        scene.on('transform', handleTransform);\n        // scheduleVisibilityUpdate();\n        asyncRender = 0;\n      }\n    }\n  }\n\n  function exit() {\n    visibleElements.forEach((el, name) => hideElement(name));\n\n    fpsUI.dispose();\n    scene.off('transform', handleTransform);\n    scene.setCameraController(mapControls);\n    scene.removeChild(boxes);\n  }\n\n  function showElement(face, name) {\n    let el = visibleElements.get(name);\n    if (!el || face !== el.face) {\n      if (el && el.face) {\n        // boxes.setFaceColor(el.face, 0x606060ff);\n        domContainer.removeChild(el.dom);\n      }\n      let a = face[0].point;\n      let b = face[1].point;\n      let c = face[2].point;\n\n      let dx = b[0] - a[0];\n      let dy = b[1] - a[1];\n      let l = Math.sqrt(dx * dx + dy * dy);\n      let dom = new DomElement({width: '400px',  height: '800px'});\n      let scale = l/400; // assume 400 px for dom element width\n\n      // center of the face\n      let ox = (a[0] + b[0]) / 2;\n      let oy = (a[1] + b[1]) / 2;\n      let oz = (a[2] + c[2]) / 2;\n\n      // face normal\n      let n = vec3.cross([], [b[0] - a[0], b[1] - a[1], b[2] - a[2]], [c[0] - a[0], c[1] - a[1], c[2] - a[2]])\n      normalize(n, n);\n      // rotate the dom plane normal ([0, 0, 1]) to match face normal\n      let q = quat.rotationTo([], [0, 0, 1], n);\n      // Rotation above is not unique, so we manually rotate dom plane until it aligns with \n      // logical box placement. This probably could be done easier, I just don't know how yet:\n      if (face.name === 'back') {\n        quat.rotateZ(q, q, -Math.PI/2)\n      } else if (face.name === 'front') {\n        quat.rotateZ(q, q, Math.PI/2)\n      } else if (face.name === 'right') {\n        quat.rotateZ(q, q, Math.PI)\n      }\n\n      mat4.fromRotationTranslationScale(dom.model, q,  [ox, oy, oz], [scale, scale, scale]);\n      dom.worldTransformNeedsUpdate = true;\n      bus.fire('append-dom', {name: name, dom: dom.el})\n      domContainer.appendChild(dom)\n\n      visibleElements.set(name, {face, dom});\n    } \n  }\n  function hideElement(name) {\n    let el = visibleElements.get(name);\n    if (el) {\n      bus.fire('remove-dom', {name: name, dom: el.dom.el})\n      domContainer.removeChild(el.dom);\n      visibleElements.delete(name);\n    }\n  }\n\n  function handleTransform(e) {\n    let dc = e.drawContext;\n    let z = dc.view.position[2];\n    if(z < 10) {\n      dc.view.position[2] = 10;\n      e.updated = true;\n    }\n    // let moveSpeed = 3+smoothStep(0, 3000, z) * 14;\n    // scene.getCameraController().setMoveSpeed(moveSpeed);\n    scheduleVisibilityUpdate();\n  }\n\n  function scheduleVisibilityUpdate() {\n    clearTimeout(visibilityUpdate);\n    let now = window.performance.now();\n    let elapsed = now - lastVisibilityUpdate;\n    if (elapsed < 500) {\n      visibilityUpdate = setTimeout(updateVisibility, elapsed);\n    } else {\n      updateVisibility();\n    }\n  }\n\n  function updateVisibility() {\n    lastVisibilityUpdate = window.performance.now();\n\n    let dc = scene.getDrawContext();\n\n    let eye = dc.view.position;\n    let center = dc.view.center;\n    let lookDirection = getDirection(eye, center);\n    let neighbors = getMostVisibleNeighbors(eye, lookDirection, /* maxNeighbors =*/ 10, /* maxAngle =*/ 35);\n    neighbors = neighbors.map(n => {\n      let dx = n.ui.position[0] - eye[0];\n      let dy = n.ui.position[1] - eye[1];\n      let dist = (dx * dx + dy * dy);\n      return {\n        ui: n.ui,\n        size: n.ui.size,\n        dist \n      }\n    }).sort((a, b) => {\n      return b.size/b.dist - a.size/a.dist; //b.ui.size - a.ui.size\n    }).slice(0, 4);\n    if (!neighbors.length) return;\n\n    let nowVisible = new Set();\n    neighbors.forEach(box => {\n      if (uiToBox.has(box.ui)) {\n        // we might not have finished rendering yet.\n        nowVisible.add(box.ui);\n      }\n    });\n    visibleBoxes.forEach(ui => {\n      if (!nowVisible.has(ui)) {\n        hideElement(ui.name);\n      }\n    });\n\n    let intersections = [];\n    nowVisible.forEach(ui => {\n      let box = uiToBox.get(ui);\n      if(!box) {\n        throw new Error('missing ui');\n      }\n\n      let minT = Infinity;\n      let minFace = box.front;\n      minT = checkFaceIntersection(box, box.front);\n\n      let t = checkFaceIntersection(box, box.back);\n      if (t < minT) { minT = t; minFace = box.back; }\n\n      t = checkFaceIntersection(box, box.left);\n      if (t < minT) { minT = t; minFace = box.left; }\n\n      t = checkFaceIntersection(box, box.right);\n      if (t < minT) { minT = t; minFace = box.right; }\n\n      if (Number.isFinite(minT)) intersections.push({t: minT, face: minFace, name: ui.name});\n    });\n\n    visibleBoxes = nowVisible;\n    intersections.sort((a, b) => a.t - b.t)\n    let count = Math.min(10, intersections.length);\n    for (let i = 0; i< count; ++i) {\n      showElement(intersections[i].face, intersections[i].name);\n    }\n    scene.renderFrame();\n\n    function checkFaceIntersection(box, face) {\n      let a = face[0].point;\n      let b = face[1].point;\n      return castRay(eye, a, b);\n    }\n\n    function castRay(from, a, b) {\n      let [r_px, r_py] = from;\n      let [s_px, s_py] = a;\n      let s_dx = b[0] - a[0];\n      let s_dy = b[1] - a[1];\n      let cx = s_px + 0.5*s_dx;\n      let cy = s_py + 0.5*s_dy;\n      let [r_dx, r_dy] = getDirection(from, [cx, cy]); \n      let t2 = (r_dx*(s_py-r_py) + r_dy*(r_px-s_px))/(s_dx*r_dy - s_dy*r_dx)\n      let ta = (s_px+s_dx*t2-r_px)/r_dx;\n      if (Number.isNaN(ta)) return 0; // ray is directly on the segment?\n      if (ta < 0) ta = Infinity; // Point is behind us\n      return ta;\n    }\n  }\n\n  function getDirection(from, to) {\n    let dir = [to[0] - from[0], to[1] - from[1]];\n    let l = Math.sqrt(dir[0]*dir[0] + dir[1] * dir[1]);\n    if (l < 1e-3) return;\n    dir[0] /= l; dir[1] /= l;\n    return dir;\n  }\n\n  function getMostVisibleNeighbors(eye, lookDirection, maxCount, maxAngle) {\n    if (!lookDirection) return []; // looking down?\n\n    // not only we find N nearest boxes, we also filter them so that\n    // only those in front of the camera are selected\n    return knn(spatialIndex, eye[0], eye[1], maxCount, checkAngle);\n\n    function checkAngle(candidate) {\n      let x = (candidate.minX + candidate.maxX)/2;\n      let y = (candidate.minY + candidate.maxY)/2;\n      let candidateDirection = getDirection(eye, [x, y])\n      if (!candidateDirection) return false;\n\n      // We take a dot product of two unit vectors which is equal to\n      // the cosine of angle between them. This lets us measure angle\n      // between the vector where camera looks and where the candidate is.\n      // If that angle is too big - we ignore the candidate.\n\n      let dot = lookDirection[0] * candidateDirection[0] + lookDirection[1] * candidateDirection[1];\n      let angle = Math.acos(dot); // no need to divide, as we are normalized\n      return angle < maxAngle * Math.PI / 180;\n    }\n  }\n}\n\nfunction normalize(out, a) {\n  let x = a[0];\n  let y = a[1];\n  let z = a[2];\n  let len = x * x + y * y + z * z;\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}","import { createScene } from 'w-gl';\nimport createSVGLoader from './createSVGLoader';\nimport {getPointsFromPathData, getElementFillColor} from 'streaming-svg-parser';\nimport PointCollection from './PointCollection';\nimport PolyLineCollection from './PolyLineCollection';\nimport TextCollection from './MSDFTextCollection';\nimport ColoredTextCollection from './ColoredTextCollection';\nimport bus, {setProgress} from './bus';\nimport createFuzzySearcher from './createFuzzySearcher';\nimport {debounce, formatNumber} from './utils'\nimport appState from '../appState';\nimport createGraph from 'ngraph.graph';\nimport createSubgraphVisualizer from './createSubgraphVisualizer';\nimport createPointerEventsHandler from './createPointerEventsHandler';\nimport createSceneLayerManager from './createSceneLayerManager';\nimport {Colors, LayerLevels, NamedGroups} from './constants';\nimport createStreetView from './createStreetView';\nimport getComplimentaryColor from './getComplimentaryColor';\n\nexport default function createStreamingSVGRenderer(canvas) {\n  let ignoreSVGViewBox = false;\n  let isStreetView = false;\n  let preStreetViewCameraPosition;\n  let inputTarget;\n  let streetView;\n  let scene = initScene();\n  let fuzzySearcher = createFuzzySearcher();\n  window.fuzzySearcher = fuzzySearcher; // TODO: Don't use window.\n\n  let persistedName = appState.query;\n  let nodes = new PointCollection(scene.getGL());\n  let boundariesFill = new PolyLineCollection(scene.getGL(), {color: 0x124182a4, opacity: 1.0});\n\n  let text = new TextCollection(scene.getGL());\n  let labelsText = new ColoredTextCollection(scene.getGL());\n\n  let loader;\n  let viewBox;\n  let currentTransform = createTransformParser();\n  let positions = [];\n\n  const nodeNameToUI = new Map();\n  const nodesByComponent = new Map();\n  const complimentaryColor = new Map();\n  const clusterColors = new Map();\n\n  const setProgressDebounced = debounce(setProgress, 100, window);\n  let subgraphVisualizer;\n  const sceneLayerManager = createSceneLayerManager(scene);\n\n  sceneLayerManager.addToLayer(boundariesFill, LayerLevels.Polygons);\n  sceneLayerManager.addToLayer(nodes, LayerLevels.Nodes);\n  sceneLayerManager.addToLayer(text, LayerLevels.Text);\n  sceneLayerManager.addToLayer(labelsText, LayerLevels.Labels)\n\n  sceneLayerManager.addToNamedGroup(boundariesFill, NamedGroups.MainGraph);\n  sceneLayerManager.addToNamedGroup(nodes, NamedGroups.MainGraph);\n  sceneLayerManager.addToNamedGroup(text, NamedGroups.MainGraph);\n  sceneLayerManager.addToNamedGroup(labelsText, NamedGroups.MainGraph);\n\n  // This is our bread and butter for touch/mouse event handling\n  const pointerEvents = createPointerEventsHandler(sceneLayerManager, {\n    elementsGroupName: NamedGroups.MainGraph,\n    onTransform: () => {\n      // we don't want to update the query string when subgraph is active\n      if (subgraphVisualizer) return;\n\n      appState.saveScenePosition(scene);\n    },\n    getGraph: () => loader && loader.getGraph(),\n    getHighlightedNodes,\n    getHighlightedLinks,\n  });\n\n  bus.on('focus-node', focusNode);\n  bus.on('unfocus', unfocus);\n  bus.on('exit-subgraph', exitSubgraphMode);\n\n  return {\n    loadSVG,\n    focus() {\n      canvas.focus();\n    },\n    isStreetViewMode() {\n      return isStreetView\n    },\n    dispose,\n    showRelated,\n    showStreetView,\n    exitStreetView,\n    getNeighbors,\n    getGraph,\n    getScene() {\n      return scene;\n    },\n  };\n\n  function getHighlightedNodes(ui) {\n    let graph = loader && loader.getGraph();\n    if (!graph) return [];\n\n    const neighbors = nodesByComponent.get(ui.componentId);\n    const hlNode = {...nodeNameToUI.get(ui.name)};\n    hlNode.color = Colors.PRIMARY_HIGHLIGHT_COLOR ;\n    let nodeUIs = [hlNode];\n    graph.forEachLinkedNode(ui.name, (other) => {\n      const hlNode = {...nodeNameToUI.get(other.id)};\n      hlNode.color = Colors.SECONDARY_HIGHLIGHT_COLOR;\n      nodeUIs.push(hlNode);\n      if (!neighbors.has(other.id)) return;\n    });\n\n    return nodeUIs;\n  }\n\n  function getHighlightedLinks(ui) {\n    let graph = loader && loader.getGraph();\n    if (!graph) return [];\n\n    let maxLinks = 10;\n    let neighbors = nodesByComponent.get(ui.componentId);\n    let secondaryLinkColor = complimentaryColor.get(ui.componentId);\n    let idx;\n    let linkUIs = [];\n\n    neighbors.forEach((neighborId) => {\n      idx = 0;\n      graph.forEachLinkedNode(neighborId, (other) => {\n        if (!neighbors.has(other.id)) return;\n        let isFirstLevel = neighborId === ui.name || other.id === ui.name;\n        if (idx > maxLinks && !isFirstLevel) return;\n        linkUIs.push({\n          from: nodeNameToUI.get(neighborId).position,\n          to: nodeNameToUI.get(other.id).position,\n          color: isFirstLevel ? 0xffffffff : secondaryLinkColor, \n          isFirstLevel\n        });\n        idx += 1;\n      });\n    });\n\n    return linkUIs;\n  }\n\n  function showStreetView(subreddit) {\n    subreddit = subreddit.split('+').map(x => x.trim())[0];\n    // sceneLayerManager.hideNamedGroup(NamedGroups.MainGraph);\n    // let graph = loader.getGraph();\n    // let node = graph.getNode(subreddit);\n    isStreetView = true;\n    let currentPointerEvents = subgraphVisualizer ? subgraphVisualizer.getPointerEvents() : pointerEvents;\n    if (!streetView) {\n      let nameToUI = subgraphVisualizer ? subgraphVisualizer.getNameToUI() : nodeNameToUI;\n      streetView = createStreetView(\n        scene, \n        currentPointerEvents.getIndex(), \n        nameToUI, \n        subreddit,\n        viewBox\n      );\n    }\n    nodes.hide();\n    currentPointerEvents.setPaused(true); // let the street view to handle the events\n    preStreetViewCameraPosition = scene.getDrawContext().view.position[2];\n    streetView.enter();\n  }\n\n  function exitStreetView() {\n    nodes.show();\n    streetView.exit();\n    streetView.dispose();\n    streetView = null;\n\n    scene.getDrawContext().view.position[2] = preStreetViewCameraPosition;\n    scene.getCameraController().setViewBox();\n    let currentPointerEvents = subgraphVisualizer ? subgraphVisualizer.getPointerEvents() : pointerEvents;\n    currentPointerEvents.setPaused(false);\n    isStreetView = false;\n    if (inputTarget) inputTarget.focus();\n  }\n\n  function lookAtNode(subreddit) {\n    if (isStreetView) {\n      streetView.lookAt(subreddit);\n    } else {\n      let node = nodeNameToUI.get(subreddit);\n      if (!node) return;\n\n      let [x, y] = node.position;\n      let size = node.size || 10;\n      size *= 2;\n      scene.setViewBox({\n        left: x - size,\n        top: y - size,\n        right: x + size,\n        bottom: y + size,\n      });\n\n      return node;\n    }\n  }\n\n  function getGraph() {\n    return loader.getGraph();\n  }\n\n  function getNeighbors(subreddit) {\n    let graph = loader.getGraph();\n    let neighbors = [];\n\n    graph.forEachLinkedNode(subreddit, otherNode => {\n      neighbors.push(otherNode.id);\n    });\n\n    return neighbors;\n  }\n\n  function showRelated(subreddit) {\n    let subgraph = createGraph();\n    subgraph.addNode(subreddit, {isRoot: true});\n\n    let graph = loader.getGraph();\n    let subgraphNodes = new Set();\n    addNeighbors(subreddit, subgraphNodes);\n\n    Array.from(subgraphNodes).forEach(node => {\n      addNeighbors(node, subgraphNodes);\n    });\n\n    subgraphNodes.forEach(node => {\n      let addedNode = subgraph.getNode(node);\n      if (!addedNode || !addedNode.data) {\n        let isFirstChild = !!(graph.hasLink(node, subreddit) || graph.hasLink(subgraph, node));\n        subgraph.addNode(node, {\n          isFirstChild,\n          size: nodeNameToUI.get(node).size,\n        });\n      }\n\n      graph.forEachLinkedNode(node, (otherNode, link) => {\n        if (!subgraphNodes.has(otherNode.id)) return;\n        if (subgraph.hasLink(link.fromId, link.toId)) return;\n\n        let isRootLevel = (link.fromId === subreddit) || (link.toId === subreddit);\n        subgraph.addLink(link.fromId, link.toId, {isRootLevel});\n      });\n    });\n\n    pointerEvents.setPaused(true); // let the subgraph to handle the events\n    if (subgraphVisualizer) {\n      // we don't want any animation here. Dispose right away!\n      subgraphVisualizer.dispose();\n      subgraphVisualizer = null;\n    } \n    runSubGraphVisualizer();\n\n    function addNeighbors(node, neighborsSet) {\n      graph.forEachLinkedNode(node, otherNode => {\n        neighborsSet.add(otherNode.id);\n      });\n    }\n\n    function runSubGraphVisualizer() {\n      subgraphVisualizer = createSubgraphVisualizer(subgraph, viewBox, sceneLayerManager, nodeNameToUI)\n      subgraphVisualizer.run();\n    }\n  }\n\n  function dispose() {\n    if (loader) loader.dispose();\n    bus.off('focus-node', focusNode);\n    bus.off('unfocus', unfocus);\n    bus.off('exit-subgraph', exitSubgraphMode);\n\n    pointerEvents.dispose();\n    scene.dispose();\n  }\n\n  function focusNode(nodeName) {\n    // this means they entered something in the search box\n    let ui = lookAtNode(nodeName);\n    if (!ui) return;\n\n    if (subgraphVisualizer) {\n      subgraphVisualizer.dispose(() => {\n        pointerEvents.setPaused(false); // we take care of the events now\n      });\n      subgraphVisualizer = null;\n    }\n\n    pointerEvents.focusUI(ui);\n    scene.renderFrame();\n    if (inputTarget) inputTarget.focus();\n  }\n\n  function unfocus() {\n    // This means they closed the sidebar\n    pointerEvents.clearHighlights();\n\n    scene.renderFrame();\n  }\n\n  function exitSubgraphMode() {\n    if (subgraphVisualizer) {\n      subgraphVisualizer.dispose(() => {\n        pointerEvents.setPaused(false); // take care of the events now\n      });\n      subgraphVisualizer = null;\n      if (inputTarget) inputTarget.focus();\n    }\n  }\n\n  function loadSVG(path) {\n    if (loader) loader.dispose();\n\n    loader = createSVGLoader(path)\n      .on('element-start', handleElementStart)\n      .on('element-end', handleElementEnd)\n      .load();\n  }\n\n  function handleElementStart(element) {\n    // TODO: this would be better done with FSM\n    if (element.tagName === 'svg') {\n      let viewBoxArr = (element.attributes.get('viewBox') || '0 0 1024 1024')\n        .split(' ')\n        .map((x) => Number.parseFloat(x))\n        .filter(finiteNumber);\n\n      if (viewBoxArr.length !== 4) throw new Error('Unknown viewBox definition: ' + element.attributes.get('viewBox'));\n\n      viewBox = {\n        left: viewBoxArr[0],\n        top: viewBoxArr[1],\n        width: viewBoxArr[2],\n        height: viewBoxArr[3],\n      };\n      pointerEvents.setViewBox(viewBox);\n\n      if (!ignoreSVGViewBox) {\n        scene.setViewBox({\n          left: viewBox.left,\n          top: viewBox.top,\n          right: viewBox.left + viewBox.width,\n          bottom: viewBox.top + viewBox.height,\n        });\n      }\n    } else if (element.tagName === 'path') {\n      addBorder(element);\n    } else if (element.tagName === 'circle') {\n      addNode(element);\n    } else {\n      let transform = element.attributes.get('transform');\n      if (transform) currentTransform.pushTransform(transform);\n    }\n  }\n\n  function handleElementEnd(element) {\n    let transform = element.attributes.get('transform');\n    if (transform) currentTransform.popTransform(transform);\n    if (element.tagName === 'text' && element.innerText) {\n      appendTextLabel(element);\n    }\n  }\n\n  function appendTextLabel(el) {\n    let fontSize = getNumericAttribute(el, 'font-size');\n    let alpha = Math.floor(\n      (el.attributes.has('fill-opacity') ? getNumericAttribute(el, 'fill-opacity') : 0.2\n    ) * 0xff);\n    let color = 0x00000000;\n    if (el.attributes.has('fill')) color = hexColor(getElementFillColor(el));\n    color = (color & (0xffffff00)) | alpha;\n    labelsText.addText({\n      x: getNumericAttribute(el, 'x'),\n      y: transformY(getNumericAttribute(el, 'y') - fontSize),\n      color,\n      text: el.innerText,\n      fontSize,\n    })\n\n  }\n\n  function addNode(el) {\n    let x = getNumericAttribute(el, 'cx', 0);\n    let y = transformY(getNumericAttribute(el, 'cy', 0));\n    let r = getNumericAttribute(el, 'r');\n    let nodeName = getTextAttribute(el, 'id');\n    if (nodeName[0] === '_') nodeName = nodeName.substr(1);\n    if (nodeNameToUI.has(nodeName)) {\n      throw new Error('Duplicate node name ' + nodeName);\n    }\n    let componentId = getTextAttribute(el.parent, 'id');\n    let neighbors = nodesByComponent.get(componentId);\n    if (!neighbors) {\n      neighbors = new Set();\n      nodesByComponent.set(componentId, neighbors);\n    }\n    neighbors.add(nodeName);\n\n    let position = currentTransform.transform(x, y);\n    let ui = {\n      componentId,\n      position,\n      color: 0xdcdcdcff,\n      size: r * 2,\n      id: positions.length,\n      name: nodeName,\n    };\n    nodeNameToUI.set(nodeName, ui);\n    positions.push(ui);\n    pointerEvents.addNode(ui);\n    nodes.add(ui);\n\n    text.addText({\n      x: position[0],\n      y: position[1] - r,\n      text: nodeName,\n      limit: 3.14 * r,\n      cx: 0.5,\n    });\n    fuzzySearcher.addWord(nodeName);\n\n    setProgressDebounced(getLoadedSubreddits);\n    scene.renderFrame();\n    if (persistedName && nodeName === persistedName && appState.query === persistedName && !appState.userTypedSomething) {\n      bus.fire('show-subreddit', nodeName);\n    }\n  }\n\n  function getLoadedSubreddits() {\n    return {\n      message: 'Loaded ' + formatNumber(nodeNameToUI.size) + ' subreddits...'\n    };\n  }\n\n  function transformY(y) {\n    return viewBox.height + viewBox.top - y;\n  }\n\n  function addBorder(el) {\n    let id = el.attributes.get('id');\n    // if (id.indexOf('polygon') === 0) return;\n\n    let { points, color } = parseBorder(el);\n    boundariesFill.addPolygon({ polygon: points, color: color });\n    let clusterId = (id && id.substr(1)) || '';\n    clusterColors.set(clusterId, color)\n    complimentaryColor.set(clusterId, getComplimentaryColor(color));\n    scene.renderFrame();\n  }\n\n  function initScene() {\n    inputTarget = document.querySelector('#events-input');\n    let scene = createScene(canvas, { \n      allowPinchRotation: false,\n      inputTarget,\n      near: 10,\n      // maxZoom: 1500000,\n      minZoom: 50,\n      useDeviceOrientation: false\n    });\n\n    scene.setClearColor(0x0f / 255, 0x0f / 255, 0x0f / 255, 0);\n\n    let cameraPosition = appState.getCameraPosition();\n    if (cameraPosition) {\n      // This is a bit fragile, but it works:\n      let position = scene.getDrawContext().view.position;\n      position[0] = cameraPosition[0];\n      position[1] = cameraPosition[1];\n      position[2] = cameraPosition[2];\n      scene.getCameraController().setViewBox();\n      ignoreSVGViewBox = true;\n    } else {\n      let initialSceneSize = 500;\n      scene.setViewBox({\n        left: -initialSceneSize,\n        top: -initialSceneSize,\n        right: initialSceneSize,\n        bottom: initialSceneSize,\n      });\n    }\n    return scene;\n  }\n\n  function parseBorder(el) {\n    let points = getPointsFromPathData(el.attributes.get('d')).map(([x, y]) => {\n      let [x0, y0] = currentTransform.transform(x, transformY(y));\n      return [x0, y0];\n    });\n    let color = hexColor(getElementFillColor(el));\n    return { points, color };\n  }\n}\n\nfunction createTransformParser() {\n  let isDirty = false;\n  let tx = 0,\n    ty = 0;\n  let transformStack = [];\n\n  return {\n    pushTransform,\n    popTransform,\n    transform,\n  };\n\n  function pushTransform(transformStr) {\n    isDirty = true;\n    transformStack.push(parseTransform(transformStr));\n  }\n\n  function popTransform() {\n    if (transformStack.length === 0) throw new Error('Nothing to pop');\n    transformStack.pop();\n    isDirty = true;\n  }\n\n  function parseTransform(str) {\n    let transformNumbers = str.match(/matrix\\((.+)\\)$/i);\n    if (!transformNumbers)\n      throw new Error('Unknown transformation record: ' + str);\n    let coefficients = transformNumbers[1]\n      .split(',')\n      .map((x) => Number.parseFloat(x))\n      .filter(finiteNumber);\n    if (coefficients.length !== 6)\n      throw new Error('Only matrix(a,b,c,d,e,f) is supported at the moment');\n    return coefficients;\n  }\n\n  function transform(x, y) {\n    updateTransform();\n    return [x + tx, y - ty, 0];\n  }\n\n  function updateTransform() {\n    if (!isDirty) return;\n\n    // TODO: this should be real math\n    tx = 0;\n    ty = 0;\n    transformStack.forEach((record) => {\n      tx += record[4];\n      ty += record[5];\n    });\n    isDirty = false;\n  }\n}\n\nfunction finiteNumber(x) {\n  return Number.isFinite(x);\n}\n\nfunction getNumericAttribute(el, name, defaultValue) {\n  let value = Number.parseFloat(el.attributes.get(name));\n  if (!Number.isFinite(value)) {\n    if (defaultValue !== undefined) return defaultValue;\n    throw new Error('Element ' + el.tagName + ' does not have a finite numeric attribute ' + name);\n  }\n  return value;\n}\n\nfunction getTextAttribute(el, name) {\n  return el.attributes.get(name) || '';\n}\n\nfunction hexColor(rgbArray) {\n  return (rgbArray[0] << 24) | (rgbArray[1] << 16) | (rgbArray[2] << 8) | 0xff;\n}\n\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_vm._v(\" \"+_vm._s(_vm.data.data)+\" \")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// Based on https://github.com/ElemeFE/element/blob/dev/src/utils/clickoutside.js\n// The MIT License (MIT), Copyright (c) 2016 ElemeFE\nconst nodeList = [];\nconst ctx = '@@clickoutsideContext';\n\nlet startClick;\nlet seed = 0;\n\ndocument.addEventListener('mousedown', e => (startClick = e));\ndocument.addEventListener('mouseup', e => {\n  nodeList.forEach(node => node[ctx].documentHandler(e, startClick));\n});\n\n// Also hide when tapped outside.\ndocument.addEventListener('touchstart', e => {\n  startClick = e;\n});\ndocument.addEventListener('touchend', e => {\n  nodeList.forEach(node => node[ctx].documentHandler(e, startClick));\n});\n\nfunction createDocumentHandler(el, binding, vnode) {\n\n  return function(mouseup = {}, mousedown = {}) {\n    if (!vnode || !vnode.context ||\n      !mouseup.target || !mousedown.target ||\n      el.contains(mouseup.target) ||\n      el.contains(mousedown.target) ||\n      el === mouseup.target ||\n      (vnode.context.popperElm &&\n      (vnode.context.popperElm.contains(mouseup.target) ||\n      vnode.context.popperElm.contains(mousedown.target)))) return;\n\n    const methodName = el[ctx].methodName;\n    if (binding.expression && methodName && vnode.context[methodName]) {\n      vnode.context[methodName]();\n    } else {\n      el[ctx].bindingFn && el[ctx].bindingFn();\n    }\n  };\n}\n\nexport default {\n  bind(el, binding, vnode) {\n    nodeList.push(el);\n    const id = seed++;\n    el[ctx] = {\n      id,\n      documentHandler: createDocumentHandler(el, binding, vnode),\n      methodName: binding.expression,\n      bindingFn: binding.value\n    };\n  },\n\n  update(el, binding, vnode) {\n    el[ctx].documentHandler = createDocumentHandler(el, binding, vnode);\n    el[ctx].methodName = binding.expression;\n    el[ctx].bindingFn = binding.value;\n  },\n\n  unbind(el) {\n    let len = nodeList.length;\n\n    for (let i = 0; i < len; i++) {\n      if (nodeList[i][ctx].id === el[ctx].id) {\n        nodeList.splice(i, 1);\n        break;\n      }\n    }\n    delete el[ctx];\n  }\n};","\n<template>\n<div>\n  {{data.data}}\n</div>\n</template>\n<script>\n\nexport default {\n  props: ['data'],\n  data() {\n    return {}\n  },\n  methods: {\n  }\n}\n</script>","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tooltip.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./Tooltip.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Tooltip.vue?vue&type=template&id=552f3579&\"\nimport script from \"./Tooltip.vue?vue&type=script&lang=js&\"\nexport * from \"./Tooltip.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"click-outside\",rawName:\"v-click-outside\",value:(_vm.hideSuggestions),expression:\"hideSuggestions\"}],staticClass:\"ak-typeahead\"},[_c('a',{staticClass:\"menu-opener\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.menuClicked($event)}}},[_c('svg',{staticClass:\"feather feather-info\",attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"24\",\"height\":\"24\",\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"stroke-width\":\"2\",\"stroke-linecap\":\"round\",\"stroke-linejoin\":\"round\"}},[_c('circle',{attrs:{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}}),_c('line',{attrs:{\"x1\":\"12\",\"y1\":\"16\",\"x2\":\"12\",\"y2\":\"12\"}}),_c('line',{attrs:{\"x1\":\"12\",\"y1\":\"8\",\"x2\":\"12.01\",\"y2\":\"8\"}})])]),_c('input',{ref:\"input\",attrs:{\"autofocus\":\"\",\"type\":\"text\",\"autocomplete\":\"off\",\"autocorrect\":\"off\",\"autocapitalize\":\"off\",\"spellcheck\":\"false\",\"placeholder\":_vm.placeholder},domProps:{\"value\":_vm.currentQuery},on:{\"input\":_vm.handleInput,\"keydown\":_vm.cycleTheList}}),(_vm.currentQuery || _vm.showClearButton)?_c('a',{staticClass:\"search-submit\",attrs:{\"type\":\"submit\",\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.clearSearch($event)}}},[_c('svg',{staticClass:\"feather feather-x-circle\",attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"24\",\"height\":\"24\",\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"stroke-width\":\"2\",\"stroke-linecap\":\"round\",\"stroke-linejoin\":\"round\"}},[_c('circle',{attrs:{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}}),_c('line',{attrs:{\"x1\":\"15\",\"y1\":\"9\",\"x2\":\"9\",\"y2\":\"15\"}}),_c('line',{attrs:{\"x1\":\"9\",\"y1\":\"9\",\"x2\":\"15\",\"y2\":\"15\"}})])]):_vm._e(),(_vm.showSuggestions)?_c('ul',{staticClass:\"suggestions\"},_vm._l((_vm.suggestions),function(suggestion,index){return _c('li',{key:index},[_c('a',{staticClass:\"suggestion\",class:{selected: suggestion.selected},attrs:{\"href\":\"#\"},domProps:{\"innerHTML\":_vm._s(suggestion.html)},on:{\"click\":function($event){$event.preventDefault();return _vm.pickSuggestion(suggestion)}}})])}),0):_vm._e(),(_vm.showLoading)?_c('ul',{staticClass:\"suggestions\"},[_c('li',{staticClass:\"searching\"},[(!_vm.loadingError)?_c('span',[_vm._v(\"Searching...\")]):_vm._e(),(_vm.loadingError)?_c('div',{staticClass:\"loading-error\"},[_c('div',[_vm._v(\"Failed to get reddit completions:\")]),_c('pre',[_vm._v(_vm._s(_vm.loadingError))])]):_vm._e()])]):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class='ak-typeahead' v-click-outside='hideSuggestions'>\n    <a href=\"#\" class='menu-opener' @click.prevent='menuClicked'>\n      <!-- Icon copyright (c) 2013-2017 Cole Bemis: https://github.com/feathericons/feather/blob/master/LICENSE -->\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-info\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"12\" y1=\"16\" x2=\"12\" y2=\"12\"></line><line x1=\"12\" y1=\"8\" x2=\"12.01\" y2=\"8\"></line></svg>\n  </a>\n    <input\n      ref='input' autofocus\n      type='text'\n      autocomplete='off'\n      autocorrect='off'\n      autocapitalize='off'\n      spellcheck='false'\n      :value='currentQuery' \n      :placeholder='placeholder'\n      @input='handleInput'\n      @keydown=\"cycleTheList\"\n    >\n    <a\n      type='submit'\n      class='search-submit'\n      href='#'\n      @click.prevent='clearSearch'\n      v-if='currentQuery || showClearButton'\n    >\n<!-- Icon copyright (c) 2013-2017 Cole Bemis: https://github.com/feathericons/feather/blob/master/LICENSE -->\n<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-x-circle\">\n  <circle cx=\"12\" cy=\"12\" r=\"10\"></circle>\n    <line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"></line>\n    <line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"></line>\n  </svg>\n</a>\n    <ul v-if=\"showSuggestions\" class=\"suggestions\">\n      <li v-for=\"(suggestion, index) in suggestions\" :key=\"index\">\n        <a\n          @click.prevent=\"pickSuggestion(suggestion)\"\n          class=\"suggestion\"\n          :class=\"{selected: suggestion.selected}\"\n          href=\"#\"\n          v-html=\"suggestion.html\"\n        ></a>\n      </li>\n    </ul>\n\n    <ul v-if=\"showLoading\" class=\"suggestions\">\n      <li class=\"searching\">\n        <span v-if=\"!loadingError\">Searching...</span>\n        <div v-if=\"loadingError\" class=\"loading-error\">\n          <div>Failed to get reddit completions:</div>\n          <pre>{{loadingError}}</pre>\n        </div>\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script>\nimport ClickOutside from '../lib/clickOutside.js'\n\nexport default {\n  directives: { ClickOutside },\n  props: {\n    placeholder: {\n      default: \"Type here\"\n    },\n    showClearButton: {\n      default: false\n    },\n    query: {\n      default: \"\"\n    },\n    delay: {\n      default: 80\n    }\n  },\n  data() {\n    return {\n      currentSelected: -1,\n      showSuggestions: false,\n      showLoading: false,\n      loadingError: null,\n      suggestions: [],\n      currentQuery: this.query\n    };\n  },\n  watch: {\n    query(newQuery) {\n      this.currentQuery = newQuery;\n    }\n  },\n  methods: {\n    refresh() {\n      if (this.showSuggestions) this.getSuggestionsInternal();\n    },\n\n    menuClicked() {\n      this.$emit('menuClicked');\n    },\n\n    hideSuggestions() {\n      this.showSuggestions = false;\n      this.showLoading = false;\n      this.pendingKeyToShow = true;\n    },\n\n    showIfNeeded(visible) {\n      // we need to wait until next key press before we can show suggestion.\n      // This avoids race conditions between search results and form submission\n      if (!this.pendingKeyToShow) this.showSuggestions = visible;\n    },\n\n    focus() {\n      this.$refs.input.focus();\n    },\n\n    pickSuggestion(suggestion) {\n      let composedQuery = this.currentQuery;\n      if (composedQuery.indexOf('+') > -1) {\n        let parts = composedQuery.split('+');\n        if (parts.length > 1) {\n          parts.pop();\n          parts.push(suggestion.text);\n          this.currentQuery = parts.map(part => part.trim()).join('+');\n        } else {\n          this.currentQuery = suggestion.text;\n        }\n      } else {\n        this.currentQuery = suggestion.text;\n      }\n      this.hideSuggestions();\n      this.$emit(\"selected\", this.currentQuery);\n    },\n\n    clearSearch() {\n      let payload = {shouldProceed: true};\n      this.$emit('beforeClear', payload);\n      if (!payload.shouldProceed) return;\n\n      this.currentQuery = '';\n      this.getSuggestionsInternal();\n      // this.focus();\n      this.$emit(\"cleared\");\n    },\n\n    handleInput(event) {\n      this.currentQuery = event.target.value;\n      this.$emit('inputChanged');\n      this.getSuggestionsInternal();\n    },\n\n    getSuggestionsInternal() {\n      var self = this;\n      if (self.previous) {\n        window.clearTimeout(self.previous);\n        self.previous = null;\n      }\n      if (!self.currentQuery) {\n        this.showSuggestions = false;\n        return;\n      }\n\n      self.previous = window.setTimeout(function() {\n        let parts = self.currentQuery.split('+')\n        let q = parts[parts.length - 1].trim();\n        var p = window.fuzzySearcher.find(q);\n\n        if (Array.isArray(p)) {\n          self.suggestions = p.map(x => ({\n            selected: false,\n            text: x.text,\n            html: x.html\n          }));\n          self.currentSelected = -1;\n          self.showIfNeeded(p && p.length > 0);\n        } else if (p) {\n          self.loadingError = null;\n          // self.showLoading = true;\n          p.then(\n            function(suggestions) {\n              self.showLoading = false;\n              suggestions = suggestions || [];\n              self.suggestions = suggestions.map(x => ({\n                selected: false,\n                text: x.text,\n                html: x.html\n              }));\n              self.currentSelected = -1;\n              self.showIfNeeded(suggestions && suggestions.length > 0);\n            },\n            function(err) {\n              self.loadingError = err;\n            }\n          );\n        } else {\n          throw new Error(\"Could not parse suggestions response\");\n        }\n      }, self.delay);\n    },\n\n    cycleTheList(e) {\n      var items = this.suggestions;\n      var currentSelected = this.currentSelected;\n      // Any key is alright for the suggestions\n      this.pendingKeyToShow = false;\n\n      let dx;\n      if (e.which === 38) {\n        // UP\n        dx = -1;\n      } else if (e.which === 40) {\n        // down\n        dx = 1;\n      } else if (e.which === 13) {\n        // Enter === accept\n        if (items[currentSelected]) {\n          this.pickSuggestion(items[currentSelected]);\n        } else {\n          this.pickSuggestion({ text: this.currentQuery });\n        }\n        e.preventDefault();\n        return;\n      } else if (e.which === 27) {\n        // Esc === close\n        this.hideSuggestions();\n      }\n\n      if (!dx || items.length === 0) return;\n\n      e.preventDefault();\n\n      if (currentSelected >= 0) {\n        this.suggestions[currentSelected].selected = false;\n      }\n      currentSelected += dx;\n      if (currentSelected < 0) currentSelected = items.length - 1;\n      if (currentSelected >= items.length) currentSelected = 0;\n\n      this.suggestions[currentSelected].selected = true;\n      this.currentSelected = currentSelected;\n    }\n  }\n};\n</script>\n\n<style lang='stylus'>\n@import '../vars.styl';\n\n.ak-typeahead {\n  height: 100%;\n  flex: 1;\n  display: flex;\n  flex-direction: row;\n  align-items: stretch;\n\n  input::-ms-clear {\n    display: none;\n  }\n}\n\n  .menu-opener {\n    display: flex;\n    align-items: center;\n    padding: 0 8px;\n    background: background-color;\n    &:hover, &:focus {\n      color: primary-color;\n      background: highlight-color;\n    }\n  }\n\n.search-submit {\n  color: border-hover;\n  position: absolute;\n  right: 0;\n  top: 0;\n  height: 100%;\n  align-items: center;\n  text-decoration: none;\n  display: flex;\n  flex-shrink: 0;\n  width: 48px;\n  justify-content: center;\n  outline: none;\n\n  &:hover, &:focus {\n    color: primary-color;\n    background: highlight-color;\n  }\n}\n\n.suggestion {\n  display: block;\n  width: 100%;\n  height: 28px;\n  display: flex;\n  align-items: center;\n  padding-left: 10px;\n  text-decoration: none;\n  font-weight: bold;\n  color: primary-text;\n\n  b {\n    font-weight: normal;\n  }\n}\n\n.suggestion:hover, .suggestion.selected {\n  background-color: highlight-color;\n  color: primary-color;\n}\n\n.suggestions {\n  position: absolute;\n  top: 48px;\n  width: 100%;\n  padding: 0;\n  background: white;\n  list-style-type: none;\n  margin: 0;\n  border-top: 1px solid $border-color;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n\n  .searching {\n    margin: 8px;\n  }\n\n  .loading-error {\n    pre {\n      color: orangered;\n      overflow-x: auto;\n      padding-bottom: 14px;\n    }\n  }\n}\n\ninput[type='text'] {\n  height: 100%;\n  width: 100%;\n  padding-left: 10px;\n  font-size: 18px;\n  border: 0;\n  border-radius: 0;\n}\n\ninput:focus {\n  outline: none;\n}\n\ninput::placeholder {\n  color: $hint-text;\n}\n\n@media (max-width: small-screen-width) {\n  .suggestion {\n    height: 42px;\n  }\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Typeahead.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Typeahead.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Typeahead.vue?vue&type=template&id=6bfb7a94&\"\nimport script from \"./Typeahead.vue?vue&type=script&lang=js&\"\nexport * from \"./Typeahead.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Typeahead.vue?vue&type=style&index=0&lang=stylus&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"sidebar\"},[_c('div',{staticClass:\"row\"},[_c('h3',[_vm._v(\"Map of Reddit\")]),_c('a',{staticClass:\"close-btn\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.onClose($event)}}},[_c('svg',{staticClass:\"feather feather-x-circle\",attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"24\",\"height\":\"24\",\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"stroke-width\":\"2\",\"stroke-linecap\":\"round\",\"stroke-linejoin\":\"round\"}},[_c('circle',{attrs:{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}}),_c('line',{attrs:{\"x1\":\"15\",\"y1\":\"9\",\"x2\":\"9\",\"y2\":\"15\"}}),_c('line',{attrs:{\"x1\":\"9\",\"y1\":\"9\",\"x2\":\"15\",\"y2\":\"15\"}})])])]),_vm._m(0)])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('p',[_vm._v(\" Each dot is a subreddit. Two dots within the same cluster are usually close to each other if multiple users frequently leave comments on both subreddits. \")]),_c('p',[_vm._v(\" If you find something missing, please feel free to \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://github.com/anvaka/map-of-reddit-data#how-to-add-a-new-subreddit\",\"target\":\"_blank\"}},[_vm._v(\"edit the map\")]),_vm._v(\". \")]),_c('p',[_vm._v(\" I spent last couple years developing this website as a hobby project. If you enjoy this work please support it \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://www.patreon.com/anvaka\"}},[_vm._v(\"on Patreon\")]),_vm._v(\" or \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://github.com/sponsors/anvaka\"}},[_vm._v(\"GitHub\")]),_vm._v(\" and I promise to not disappoint you with new features :). \")]),_c('p',[_vm._v(\" Please follow me on Twitter to stay in touch: \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://twitter.com/anvaka\"}},[_vm._v(\"https://twitter.com/anvaka\")]),_vm._v(\". \")]),_c('p',[_vm._v(\" Thank you for your interest and support! \")])])}]\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"sidebar\">\n    <div class='row'>\n      <h3>Map of Reddit</h3>\n      <!-- Icon copyright (c) 2013-2017 Cole Bemis: https://github.com/feathericons/feather/blob/master/LICENSE -->\n        <a href='#' @click.prevent='onClose' class='close-btn'>\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-x-circle\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"></line><line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"></line></svg>\n        </a>\n    </div>\n\n    <div class=\"container\">\n      <p>\n        Each dot is a subreddit. Two dots within the same cluster are \n        usually close to each other if multiple users frequently leave comments on both subreddits.\n      </p>\n      <p>\n        If you find something missing, please feel free to <a href='https://github.com/anvaka/map-of-reddit-data#how-to-add-a-new-subreddit' target='_blank' class='accent'>edit the map</a>.\n      </p>\n      <p>\n        I spent last couple years developing this website as a hobby project. If you enjoy\n        this work please support it <a href=\"https://www.patreon.com/anvaka\" class='accent'>on Patreon</a> or\n        <a href=\"https://github.com/sponsors/anvaka\" class='accent'>GitHub</a> and I promise to not disappoint you\n        with new features :).\n      </p>\n      <p>\n      Please follow me on Twitter  to stay in touch: <a href='https://twitter.com/anvaka' class='accent'>https://twitter.com/anvaka</a>.\n      </p>\n      <p>\n        Thank you for your interest and support!\n      </p>\n    </div>\n  </div>\n</template>\n<script>\nexport default {\n  mounted() {\n    window.addEventListener('keydown', this.handleKeyDown);\n  },\n  beforeDestroy() {\n    window.removeEventListener('keydown', this.handleKeyDown);\n  },\n  methods: {\n    onClose() {\n      this.$emit('close');\n    },\n    handleKeyDown(e) {\n      if (e.which === 27 /* ESC */) {\n        this.onClose();\n      }\n    }\n  }\n}\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Sidebar.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Sidebar.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Sidebar.vue?vue&type=template&id=6b61a779&\"\nimport script from \"./Sidebar.vue?vue&type=script&lang=js&\"\nexport * from \"./Sidebar.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('h3',[_vm._v(\"Improve this map\")]),_c('a',{staticClass:\"close-btn\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.onClose($event)}}},[_c('svg',{staticClass:\"feather feather-x-circle\",attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":\"24\",\"height\":\"24\",\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"stroke-width\":\"2\",\"stroke-linecap\":\"round\",\"stroke-linejoin\":\"round\"}},[_c('circle',{attrs:{\"cx\":\"12\",\"cy\":\"12\",\"r\":\"10\"}}),_c('line',{attrs:{\"x1\":\"15\",\"y1\":\"9\",\"x2\":\"9\",\"y2\":\"15\"}}),_c('line',{attrs:{\"x1\":\"9\",\"y1\":\"9\",\"x2\":\"15\",\"y2\":\"15\"}})])]),_c('p',[_vm._v(\"The entire website is open source. You can contribute in multiple ways:\")]),_vm._m(0),_vm._v(\" Thank you for your support! \"),_c('br'),_vm._v(\" ♥️ Anvaka \")])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ul',[_c('li',[_vm._v(\" Discuss this product on our own subreddit: \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://www.reddit.com/r/MofR/\"}},[_vm._v(\"/r/MofR\")])]),_c('li',[_vm._v(\"Support this work \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://www.patreon.com/anvaka\"}},[_vm._v(\"on Patreon\")]),_vm._v(\" or \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://github.com/sponsors/anvaka\"}},[_vm._v(\"GitHub\")]),_vm._v(\". There is a lot of things I'd love to improve about this project, but without your support I wouldn't know if I'm moving in the right direction. \")]),_c('li',[_vm._v(\" Add new subreddits or update positions of existing ones if you found an issue. Please follow instructions \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://github.com/anvaka/map-of-reddit-data#how-to-add-a-new-subreddit\",\"target\":\"_blank\"}},[_vm._v(\"here\")]),_vm._v(\". \")]),_c('li',[_vm._v(\"If you found a rendering bug - consider reporting it or fixing it \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://github.com/anvaka/map-of-reddit\",\"target\":\"_blank\"}},[_vm._v(\"here\")]),_vm._v(\". \")]),_c('li',[_vm._v(\" Share your suggestions and follow me on Twitter. My direct messages are open: \"),_c('a',{staticClass:\"accent\",attrs:{\"href\":\"https://twitter.com/anvaka\"}},[_vm._v(\"https://twitter.com/anvaka\")])])])}]\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <h3>Improve this map</h3>\n    <!-- Icon copyright (c) 2013-2017 Cole Bemis: https://github.com/feathericons/feather/blob/master/LICENSE -->\n    <a href='#' @click.prevent='onClose' class='close-btn'>\n      <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-x-circle\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"></line><line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"></line></svg>\n    </a>\n    <p>The entire website is open source. You can contribute in multiple ways:</p>\n    <ul>\n      <li>\n        Discuss this product on our own subreddit: <a href='https://www.reddit.com/r/MofR/' class='accent'>/r/MofR</a>\n      </li>\n      <li>Support this work <a href=\"https://www.patreon.com/anvaka\" class='accent'>on Patreon</a> or\n      <a href=\"https://github.com/sponsors/anvaka\" class='accent'>GitHub</a>. There is a lot of things\n      I'd love to improve about this project, but without your support I wouldn't know if I'm moving\n      in the right direction.\n      </li>\n      <li>\n        Add new subreddits or update positions of existing ones if you found an issue. Please \n        follow instructions  <a href='https://github.com/anvaka/map-of-reddit-data#how-to-add-a-new-subreddit'\n        class='accent' target='_blank'>here</a>.\n      </li>\n      <li>If you found a rendering bug - consider reporting it or fixing it \n        <a href='https://github.com/anvaka/map-of-reddit' class='accent' target='_blank'>here</a>.\n      </li>\n      <li>\n        Share your suggestions and follow me on Twitter. My direct messages are open: \n<a href='https://twitter.com/anvaka' class='accent'>https://twitter.com/anvaka</a>\n      </li>\n    </ul>\n    Thank you for your support! <br/>\n    ♥️ Anvaka\n  </div>\n</template>\n\n<script>\nexport default {\n  mounted() {\n    window.addEventListener('keydown', this.handleKeyDown);\n  },\n  beforeDestroy() {\n    window.removeEventListener('keydown', this.handleKeyDown);\n  },\n  methods: {\n    onClose() {\n      this.$emit('close');\n    },\n    handleKeyDown(e) {\n      if (e.which === 27 /* ESC */) {\n        this.onClose();\n      }\n    }\n  }\n}\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImproveWindow.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ImproveWindow.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ImproveWindow.vue?vue&type=template&id=6f529b0a&\"\nimport script from \"./ImproveWindow.vue?vue&type=script&lang=js&\"\nexport * from \"./ImproveWindow.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('a',{staticClass:\"small-preview-container\",attrs:{\"href\":\"#\"},on:{\"click\":function($event){$event.preventDefault();return _vm.showFullPreview($event)}}},[_c('div',{staticClass:\"header\"},[_c('span',[_vm._v(\"r/\"+_vm._s(_vm.name))]),(_vm.details)?_c('span',{staticClass:\"subscribers-count\"},[_vm._v(_vm._s(_vm.details.subscribers)+\" members · \"+_vm._s(_vm.details.active)+\" active\")]):_vm._e()]),(_vm.loading)?_c('loading-icon'):_vm._e(),(_vm.details && _vm.details.image)?_c('img',{staticClass:\"community-icon\",attrs:{\"src\":_vm.details.image.icon}}):_vm._e(),(_vm.details)?_c('div',{staticClass:\"info\"},[_vm._v(_vm._s(_vm.details.description))]):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('svg',{staticClass:\"loader\",attrs:{\"xmlns\":\"http://www.w3.org/2000/svg\",\"viewBox\":\"0 0 32 32\",\"width\":\"28\",\"height\":\"28\",\"fill\":\"white\"}},[_c('path',{attrs:{\"opacity\":\".25\",\"d\":\"M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4\"}}),_c('path',{attrs:{\"d\":\"M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z\"}},[_c('animateTransform',{attrs:{\"attributeName\":\"transform\",\"type\":\"rotate\",\"from\":\"0 16 16\",\"to\":\"360 16 16\",\"dur\":\"0.8s\",\"repeatCount\":\"indefinite\"}})],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./LoadingIcon.vue?vue&type=template&id=83262da8&\"\nvar script = {}\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <a href='#' @click.prevent='showFullPreview' class='small-preview-container'>\n    <div class='header'>\n      <span>r/{{name}}</span>\n      <span v-if='details' class='subscribers-count'>{{details.subscribers}} members · {{details.active}} active</span>\n    </div>\n    <loading-icon v-if='loading'></loading-icon>\n    <img v-if='details && details.image' :src='details.image.icon' class='community-icon'>\n    <div class='info' v-if='details'>{{details.description}}</div>\n    <!-- <div class='thumbnails' v-if='details && details.image'>\n      <img v-if='details.image.banner' :src='details.image.banner' class='banner'>\n      <img :src='details.image.icon' class='community-icon'>\n    </div> -->\n  </a>\n</template>\n<script>\nimport bus from './lib/bus';\nimport LoadingIcon from './LoadingIcon'\nimport {formatNumber} from './lib/utils';\n\nexport default {\n  name: 'SmallPreview',\n  props: ['name'],\n  components: {\n    LoadingIcon\n  },\n  data() {\n    return {\n      loading: true,\n      details: null\n    }\n  },\n  watch: {\n    name() {\n      this.getSubredditInfo();\n    }\n  },\n  mounted() {\n    this.getSubredditInfo();\n  },\n  methods: {\n    showFullPreview() {\n      bus.fire('show-subreddit', this.name, true);\n    },\n    getSubredditInfo() {\n      let fetchedName = this.name;\n      this.details = null;\n      this.loading = true;\n      fetch('https://www.reddit.com/r/' + fetchedName + '/about.json', {mode: 'cors'})\n        .then(x => x.json())\n        .then(x => {\n          if (this.name !== fetchedName) return;\n          let data = x.data;\n          let description = data.public_description;\n          let displayName = data.display_name_prefixed;\n          let subscribers = formatNumber(data.subscribers);\n          let active = formatNumber(data.accounts_active);\n          this.loading = false;\n          let image = null;\n          let icon = data.icon_img || data.community_icon;\n          if (icon) {\n            let banner = data.banner_img || data.banner_background_image;\n            image = {\n              icon: icon.split('?')[0],\n              banner: banner ? banner.split('?')[0] : null\n            }\n          }\n          if (data.over18 && !window.ageConfirmed) {\n            image = null;\n          }\n          this.details = {\n            description, displayName, subscribers, active, image\n          }\n        })\n    }\n  }\n};\n</script>\n<style lang=\"stylus\">\ntext-color = #eee;\n.loader {\n  margin: 8px;\n}\n.header {\n  font-size: 16px;\n}\n.small-preview-container {\n  padding: 4px 8px;\n  font-size: 12px;\n  color: text-color;\n  a {\n    color: text-color;\n  }\n}\n.info {\n  margin-top: 4px;\n  display: -webkit-box;\n  -webkit-line-clamp: 3;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n}\n.subscribers-count {\n  color: #999999;\n  float: right;\n  display: inline-block;\n  font-size: 12px;\n}\n.community-icon {\n  width: 32px;\n  border-radius: 100%;\n  margin: 8px;\n  float: left;\n}\n.banner {\n  // height: 48px;\n  width: 100%;\n  position: absolute;\n  top: 0px;\n}\n.thumbnails {\n  overflow: hidden;\n  position: absolute;\n  bottom: 84px;\n  width: 100%;\n  height: 48px;\n  background: orange;\n  left: 0;\n}\n</style>","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./SmallPreview.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./SmallPreview.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SmallPreview.vue?vue&type=template&id=7b1a6d47&\"\nimport script from \"./SmallPreview.vue?vue&type=script&lang=js&\"\nexport * from \"./SmallPreview.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SmallPreview.vue?vue&type=style&index=0&lang=stylus&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export default function createFirstInteractionListener(callback) {\n  window.addEventListener('mousedown', handleFirstEvent, true);\n  window.addEventListener('wheel', handleFirstEvent, true);\n  window.addEventListener('touchstart', handleFirstEvent, true);\n  window.addEventListener('keydown', handleFirstEvent, true);\n\n  let called = false;\n\n  return dispose;\n\n  function handleFirstEvent() {\n    if (called) return;\n    called = true;\n    callback();\n  }\n\n  function dispose() {\n    window.removeEventListener('mousedown', handleFirstEvent, true);\n    window.removeEventListener('wheel', handleFirstEvent, true);\n    window.removeEventListener('touchstart', handleFirstEvent, true);\n    window.removeEventListener('keydown', handleFirstEvent, true);\n  }\n}","<template>\n  <div id=\"app\">\n    <div v-if='!isWebGLEnabled'>\n      <div class='absolute no-webgl'>\n        <h4>WebGL is not enabled :(</h4>\n        <p>This website needs <a href='https://en.wikipedia.org/wiki/WebGL' class='accent'>WebGL</a> to render a map of reddit.\n        </p> <p>\n        You can try another browser. If the problem persists - very likely your video card isn't supported.\n        </p>\n      </div>\n    </div>\n    <div v-if='isWebGLEnabled'>\n    <transition name='fade'>\n      <div class='progress' v-if='progressMessage'>{{progressMessage}}</div>\n    </transition>\n    <transition name='fade'>\n      <div class='progress subgraph' v-if='subgraphName && !isStreetViewMode'>\n        Only <a href='#' class='accent' @click.prevent='onSubgraphRootClick'>/r/{{subgraphName}}</a> related subreddits are shown.\n        <a href='#' class='accent' @click.prevent='onExitSubgraph'>view all</a>\n      </div>\n    </transition>\n    <transition name='fade'>\n      <div class='progress subgraph' v-if='isStreetViewMode && !isStreetViewInProgress'>\n        <a href='#' class='accent' @click.prevent='onExitStreetView'>exit street view</a>\n      </div>\n    </transition>\n    <subreddit v-if=\"subreddit\" :name=\"subreddit\" :sort=\"defaultSort\" :time=\"defaultTime\" class=\"preview\" @declineAge='onDeclineAge'>\n      <template slot='after-title'>\n        <div>\n          <a href='#' class='subreddit-action' @click.prevent='showRelated' v-if='graphLoaded'>Show related</a>\n          <a href='#' class='subreddit-action' @click.prevent='showStreetView' v-if='streetViewEnabled && graphLoaded && !isSubgraphLayoutInProgress'>Street view</a>\n          <div v-if='graphLoaded'>\n            <input type=\"checkbox\" id=\"checkbox\" v-model=\"multiView\">\n            <label for=\"checkbox\">Multireddit view from neighbors</label>\n          </div>\n          <span v-if='!graphLoaded' class='subreddit-action'>the map is still loading...</span>\n        </div>\n      </template>\n    </subreddit>\n    <form @submit.prevent=\"onSubmit\" class=\"search-box\">\n      <typeahead\n        placeholder=\"Find subreddit\"\n        @menuClicked='sidebarVisible = true'\n        @selected='findSubreddit'\n        @beforeClear='closeSubredditOnSmallScreen'\n        @cleared='closeSubredditViewer'\n        @inputChanged='onTypeAheadInput'\n        :showClearButton=\"subreddit\"\n        :query=\"appState.query\"\n      ></typeahead>\n    </form>\n\n    <div class=\"support\" :class=\"{subgraph: subgraphName && !isStreetViewMode, street: isStreetViewMode}\" v-if=\"graphLoaded && progressMessage === null\">\n      Enjoying this map? <br>\n      <a href='https://patreon.com/anvaka' target=\"_blank\"  class='accent'>Support the author</a>\n    </div>\n    <a href='#' @click.prevent='onImproveClick' class='accent improve'>Improve this map</a>\n    <transition name='slide-bottom'>\n      <small-preview v-if=\"smallPreview\" :name=\"smallPreview\" class=\"small-preview\"></small-preview>\n    </transition>\n\n    <transition name='slide-top'>\n      <improve-window v-if='improveVisible' @close='improveVisible = false' class='improve-window'></improve-window>\n    </transition>\n\n    <tooltip\n      v-if=\"tooltip\"\n      :style=\"{\n      left: tooltip.x + 'px',\n      top: tooltip.y + 'px'\n    }\"\n      :data=\"tooltip\"\n      class=\"tooltip\"\n    ></tooltip>\n\n    <transition name='fade'>\n      <div class='backdrop' v-if='sidebarVisible || improveVisible' @click=\"onBackdropClick\"></div>\n    </transition>\n    <transition name='slide-left'>\n      <sidebar v-if=\"sidebarVisible\" @close='sidebarVisible = false'></sidebar>\n    </transition>\n    </div>\n  </div>\n</template>\n\n<script>\nimport \"vuereddit/dist/vuereddit.css\";\n\nimport Vue from 'vue';\nimport createStreamingSVGRenderer from './lib/createStreamingSVGRenderer';\nimport Tooltip from \"./Tooltip\";\nimport Typeahead from \"./components/Typeahead\";\nimport Sidebar from \"./components/Sidebar\";\nimport ImproveWindow from \"./components/ImproveWindow\";\nimport Subreddit from \"vuereddit\";\nimport SmallPreview from \"./SmallPreview\";\nimport appState from \"./appState.js\";\nimport createFirstInteractionListener from './lib/createFirstInteractionListener';\nimport {isWebGLEnabled} from 'w-gl';\n\nimport bus from \"./lib/bus\";\n\nlet Instance = Vue.extend(Subreddit);\nlet nameToInstance = new Map();\n\nexport default {\n  components: {\n    Tooltip,\n    Typeahead,\n    Subreddit,\n    Sidebar,\n    ImproveWindow,\n    SmallPreview,\n  },\n  name: \"app\",\n  watch: {\n    multiView(newValue) {\n      let from = getFirstSubreddit(this.subreddit);\n      let newQuery;\n\n      if (newValue) {\n        let all = this.scene.getNeighbors(from);\n        all.unshift(from);\n        newQuery = all.join('+');\n      } else {\n        newQuery = from;\n      }\n      this.showSubreddit(newQuery)\n    }\n  },\n  methods: {\n    showRelated() {\n      this.scene.showRelated(this.subreddit);\n      this.isSubgraphLayoutInProgress = true;\n      if (isSmallScreen()) {\n        // move panel to the bottom\n        this.smallPreview = this.subreddit;\n        this.subreddit = null;\n      }\n    },\n    showStreetView() {\n      this.scene.showStreetView(this.subreddit);\n      this.subreddit = null;\n      this.tooltip = null;\n      this.isStreetViewMode = true;\n      this.isStreetViewInProgress = true;\n    },\n    onExitStreetView() {\n      this.isStreetViewInProgress = false;\n      this.scene.exitStreetView();\n      this.isStreetViewMode = false;\n    },\n    findSubreddit(q) {\n      appState.query = q;\n      this.onSubmit();\n    },\n    closeSubredditOnSmallScreen(payload) {\n      appState.userTypedSomething = true;\n      if (isSmallScreen() && this.subreddit) {\n        // First time - just close the subreddit, second time - clear all\n        payload.shouldProceed = false;\n        this.subreddit = null;\n        this.scene.focus();\n      } \n    },\n    onTypeAheadInput() {\n      this.typeaheadChanged = true;\n      appState.userTypedSomething = true;\n    },\n    onDeclineAge(e) {\n      e.preventDefault();\n      this.closeSubredditViewer();\n    },\n    onBackdropClick() {\n      this.sidebarVisible = false;\n      this.improveVisible = false;\n    },\n    onImproveClick() {\n      this.improveVisible = true;\n    },\n    closeSubredditViewer() {\n      this.subreddit = null;\n      this.smallPreview = null;\n      appState.query = '';\n      appState.saveQuery(appState.query);\n      bus.fire('unfocus');\n    },\n    showTooltip(e) {\n      if (e) {\n        this.tooltip = e;\n      } else {\n        this.tooltip = null;\n      }\n    },\n    onSubmit() {\n      let originalQuery = appState.query;\n      bus.fire('focus-node', getFirstSubreddit(originalQuery));\n      if (originalQuery !== appState.query) {\n        // This is due to 'show-subreddit' event floating from 'focus-node'\n        // in the scene renderer. Insist that we keep the original input:\n        appState.saveQuery(originalQuery);\n        if (originalQuery && originalQuery.indexOf('+') > -1) {\n          this.subreddit = originalQuery;\n        }\n      }\n      this.subgraphName = null;\n    },\n    onSubgraphRootClick() {\n      bus.fire('subgraph-focus-node', this.subgraphName);\n    },\n    onExitSubgraph() {\n      bus.fire('exit-subgraph');\n      this.subgraphName = null;\n      this.isSubgraphLayoutInProgress = false;\n    },\n    showSubreddit(subreddit, forceFullView) {\n      if (subreddit !== this.subreddit) {\n        this.multiView = subreddit && subreddit.indexOf('+') > -1;\n      }\n      if (!this.scene.isStreetViewMode()) {\n        if (isSmallScreen() && !forceFullView) {\n          this.smallPreview = subreddit;\n        } else {\n          this.smallPreview = null;\n          this.subreddit = subreddit;\n        }\n      }\n      appState.query = subreddit;\n      this.tooltip = null;\n      appState.saveQuery(appState.query);\n    },\n\n    setProgress(progress) {\n      if (progress && progress.mapLoaded) {\n        // last message!\n        if (!this.typeaheadChanged) {\n          this.progressMessage = progress.error ? 'Something is likely not right...' : 'Map is ready to use. Please enjoy';\n        }\n        this.graphLoaded = true;\n        this.disposeFirstListener = createFirstInteractionListener(() => {\n          setTimeout(() => this.progressMessage = null, 3000);\n        });\n      } else if (progress && progress.subgraphDone) {\n        this.progressMessage = null;\n        this.subgraphName = progress.subgraphName;\n        this.isSubgraphLayoutInProgress = false;\n      }  else if (progress && progress.streetViewDone) {\n        this.progressMessage = null;\n        this.isStreetViewInProgress = false;\n      } else if (progress) {\n        this.progressMessage = progress.message;\n        this.subgraphVisualized = null;\n      } \n    },\n    appendDom(e) {\n      // TODO: Consider window.requestIdleCallback?\n      let oldInstance = nameToInstance.get(e.name);\n      if (oldInstance) {\n        oldInstance.$destroy();\n      }\n      let div = document.createElement('div');\n      let viewer = new Instance({propsData: { \n        name: e.name,\n        showFirst: 5,\n        sort: this.defaultSort || 'hot',\n        time: this.defaultTime || 'day'\n      }});\n      viewer.$on('sortChanged', (newSort) => this.defaultSort = newSort);\n      viewer.$on('timeChanged', (newTime) => {\n        this.defaultTime = newTime;\n      });\n      e.dom.appendChild(div);\n      let instance = viewer.$mount(div);\n      nameToInstance.set(e.name, instance)\n    },\n    removeDom(e) {\n      let oldInstance = nameToInstance.get(e.name);\n      if (oldInstance) {\n        oldInstance.$destroy();\n        nameToInstance.delete(e.name);\n      }\n    }\n  },\n  data() {\n    return {\n      improveVisible: false,\n      isWebGLEnabled: false,\n      isStreetViewMode: false,\n      isSubgraphLayoutInProgress: false,\n      isStreetViewInProgress: false,\n      typeaheadChanged: false,\n      tooltip: null,\n      subgraphName: null,\n      subreddit: null,\n      scene: null,\n      smallPreview: null,\n      sidebarVisible: false,\n      progressMessage: '',\n      graphLoaded: false,\n      multiView: false,\n      streetViewEnabled: appState.getQueryState().get('sv') !== false,\n      defaultSort: 'hot',\n      defaultTime: 'day',\n      appState,\n    };\n  },\n  mounted() {\n    const canvas = document.getElementById(\"cnv\");\n    nameToInstance = new Map();\n    this.isWebGLEnabled = isWebGLEnabled(canvas);\n    if (!this.isWebGLEnabled) return;\n\n    let svgRenderer = createStreamingSVGRenderer(canvas);\n    window.getGraph = svgRenderer.getGraph;\n    let path = appState.getFilePath();\n    svgRenderer.loadSVG(path);\n    this.scene = svgRenderer;\n\n    bus.on('show-tooltip', this.showTooltip);\n    bus.on('show-subreddit', this.showSubreddit);\n    bus.on('progress', this.setProgress);\n    bus.on('append-dom', this.appendDom);\n    bus.on('remove-dom', this.removeDom);\n  },\n\n  beforeDestroy() {\n    if (this.scene) {\n      this.scene.dispose();\n    }\n    if (this.disposeFirstListener) {\n      this.disposeFirstListener();\n    }\n    bus.off('show-tooltip', this.showTooltip);\n    bus.off('show-subreddit', this.showSubreddit);\n    bus.off('progress', this.setProgress);\n    bus.off('append-dom', this.appendDom);\n    bus.off('remove-dom', this.removeDom);\n  }\n};\n\nfunction isSmallScreen() {\n  return window.innerWidth < 550;\n}\n\nfunction getFirstSubreddit(potentiallyMultiViewName) {\n  return potentiallyMultiViewName && potentiallyMultiViewName.split('+').map(x => x.trim())[0]\n}\n</script>\n\n<style lang='stylus'>\n@import './vars.styl';\n\n#app {\n  position: absolute;\n  top: 0;\n  background: background-color;\n}\n.no-webgl {\n  width: 100%;\n  color: hsla(215, 37%, 55%, 1);\n  flex-direction: column; text-align: center;\n  padding: 12px;\n}\n.no-webgl h4 {\n  margin: 7px 0;\n  font-size: 24px;\n}\n.subreddit .subreddit-action {\n  display: inline-block;\n  border: 1px solid;\n  color: primary-color;\n  border-radius: 3px;\n  padding: 0 8px;\n  margin: 8px;\n}\n\n.subreddit span.subreddit-action {\n  border-color: border-color;\n}\n\n.backdrop {\n  position fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.21);\n}\n\n.close-container {\n  position: fixed;\n  z-index: 2;\n  top: 0;\n  right: 0;\n  height: 40px;\n\n  a {\n    padding: 0 12px;\n    font-size: 12px;\n    color: #fff;\n    background-color: #333;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n  }\n}\n.support {\n  position: fixed;\n  background: rgba(0, 0, 0, 0.3);\n  padding: 0 8px;\n  font-size: 12px;\n  right: 8px;\n  top: 8px;\n  color: white;\n}\n.improve {\n  position: fixed;\n  background: rgba(0, 0, 0, 0.3);\n  padding: 0 8px;\n  font-size: 12px;\n  right: 8px;\n  bottom: 8px;\n}\n\n.fade-enter-active, .fade-leave-active {\n  transition: opacity .5s;\n}\n.fade-enter, .fade-leave-to {\n  opacity: 0;\n}\n\n.slide-bottom-enter-active, .slide-bottom-leave-active {\n  transition: transform .3s cubic-bezier(0,0,0.58,1);\n}\n.slide-bottom-enter, .slide-bottom-leave-to {\n  transform: translateY(84px);\n}\n\n.small-preview {\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 84px;\n  background: rgba(5, 15, 43, 1); \n  box-shadow: 0 -4px 4px rgba(0,0,0,0.42);\n}\n\n.subreddit.preview {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: side-panel-width + 16px;\n  height: 100vh;\n  overflow: auto;\n}\n\n.row {\n  display: flex;\n  flex-direction: row;\n  align-items: baseline;\n}\n\n.row .label {\n  flex: 1;\n}\n\n.row .value {\n  flex: 1;\n}\n\n.row select {\n  width: 100%;\n}\n\n.btn-command {\n  display: block;\n  padding: 4px;\n  margin-top: 10px;\n  border: 1px solid;\n}\n\n.tooltip {\n  position: fixed;\n  background: post-background;\n  border: 1px solid border-hover;\n  color: primary-color;\n  padding: 8px;\n  pointer-events: none;\n  max-width: 400px;\n  transform: translateY(calc(-100% - 8px));\n  font-family: monospace;\n}\n\n.subreddit {\n  background: panel-background;\n  box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);\n  color: highlight-color;\n  .error {\n    color: white;\n    h3 {\n      color: error-color;\n    }\n  }\n  .background-area {\n    background: post-background;\n    border-bottom: 1px solid border-color;\n\n    .community-icon {\n      background: post-background;\n    }\n  }\n  h2, h3 {\n    color: primary-color;\n  }\n  .loading {\n    margin-top: 8px;\n  }\n  .age-warning  {\n    h2 {\n      text-align: center;\n      display: inline-block;\n    }\n  }\n  .error,\n  .age-warning {\n    margin-top: 62px;\n  }\n  a {\n    color: highlight-color;\n  }\n  .post {\n    background: post-background;\n    border: 1px solid border-color;\n    .url {\n      color: inherit;\n    }\n    .title, h1 {\n      color: primary-color;\n    }\n    a.comments-count {\n      &:hover {\n        background: hover-background;\n      }\n    }\n    .post-content, .byline {\n      a:hover {\n        background: hover-background;\n      }\n    }\n    .status-line {\n      background-color: #161617;\n      .vote-count {\n        color: primary-color;\n        background: initial;\n      }\n    }\n    .read-more {\n      background-image: linear-gradient(180deg,hsla(0,0%,100%,0), #171718);\n    }\n    &:hover {\n      border: 1px solid border-hover;\n    }\n  }\n}\n\na {\n  color: highlight-color;\n  text-decoration: none;\n}\n.search-box {\n  position: absolute;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2), 0 -1px 0px rgba(0, 0, 0, 0.02);\n  height: 48px;\n  font-size: 16px;\n  margin-top: 16px;\n  padding: 0;\n  cursor: text;\n  left: 8px;\n  width: side-panel-width;\n}\n\n.progress {\n  position: fixed;\n  top: 0px;\n  left: 50%;\n  transform: translateX(-50%);\n  color: white;\n  padding: 8px;\n  background: rgba(5, 15, 43, 0.4);\n  box-shadow: 0 4px 4px rgba(0,0,0,0.2);\n  user-select: none;\n}\n\n.slide-left-enter-active, .slide-left-leave-active {\n  transition: transform 150ms cubic-bezier(0,0,0.58,1);\n}\n.slide-left-enter, .slide-left-leave-to {\n  transform: translateX(-100%);\n}\n\n.slide-top-enter-active, .slide-top-leave-active {\n  transition: opacity .3s cubic-bezier(0,0,0.58,1);\n}\n.slide-top-enter, .slide-top-leave-to {\n  opacity: 0;\n}\n.improve-window {\n  position: fixed;\n  transform: translate(-50%, -50%);\n  top: 0;\n  left: 50%;\n  top: 50%;\n  width: 400px;\n  background: white;\n  z-index: 2;\n  box-shadow: 0 -1px 24px rgb(0 0 0);\n  padding: 8px 16px;\n  overflow-y: auto;\n  max-height: 100%;\n  h3 {\n    margin: 0;\n  }\n  .close-btn {\n    position: absolute;\n    right: 8px;\n    top: 8px;\n  }\n}\na.accent {\n  color: highlight-link;\n}\n.sidebar {\n  position: fixed;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  width: side-panel-width - 10px;\n  background: white;\n  z-index: 2;\n  box-shadow: 0 -1px 24px rgb(0 0 0);\n  display: flex;\n  flex-direction: column;\n\n  h3 {\n    font-weight: normal;\n    margin: 8px 8px 0 8px;\n    font-size: 18px;\n    flex: 1;\n  }\n  .close-btn {\n    align-self: stretch;\n    align-items: center;\n    display: flex;\n    padding: 0 8px;\n  }\n\n  .container {\n    padding: 8px;\n    flex: 1;\n    overflow-y: auto;\n  }\n  h4 {\n    margin: 0;\n    font-weight: normal;\n    text-align: right;\n  }\n  .byline {\n    margin: 0 8px 8px;\n    font-size: 12px;\n  }\n}\n.progress.subgraph {\n  max-width: 400px;\n  text-align: center;\n}\n\n@media (max-width: 1200px) {\n  .progress {\n    top: 16px;\n    right: 8px;\n    left: inherit;\n    transform: inherit;\n  }\n  .support.subgraph {\n    top: 80px;\n  }\n}\n@media (max-width: 810px) {\n  .progress.subgraph {\n    top: 62px;\n    left: 8px;\n  }\n}\n\n@media (max-width: small-screen-width) {\n  #app {\n    width: 100%;\n    margin: 0;\n  }\n  .sidebar {\n    width: 100%;\n  }\n  .search-box {\n    left: 0;\n    margin-top: 0;\n    width: 100%;\n  }\n  .support {\n    bottom: 8px;\n    left: 8px;\n    right: unset;\n    top: unset;\n  }\n  .support.subgraph {\n    top: unset;\n  }\n\n  .improve-window {\n    width: 100%;\n    height: 100%;\n  }\n  .subreddit.preview {\n    width: 100%;\n  }\n  .progress, .progress.subgraph  {\n    top: 48px;\n    left: 0;\n    color: white;\n    text-align: center;\n    width: 100%;\n    position: absolute;\n    transform: initial;\n    box-shadow: initial;\n  }\n  .support.street {\n    display: none;\n  }\n}\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=53451e78&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=stylus&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\nimport App from './App.vue'\n\nVue.config.productionTip = false\n\nnew Vue({\n  render: h => h(App),\n}).$mount('#app')\n\ndocument.querySelector('.loading-script')?.remove();","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--12-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--12-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--12-oneOf-1-2!../node_modules/stylus-loader/index.js??ref--12-oneOf-1-3!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=stylus&\""],"sourceRoot":""}